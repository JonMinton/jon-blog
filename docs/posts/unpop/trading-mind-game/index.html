<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.3.450">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Jon Minton">
<meta name="dcterms.date" content="2024-03-29">

<title>Jon Minton’s Blog - The Trading Mind Game</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
</style>


<script src="../../../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../../../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../../../site_libs/clipboard/clipboard.min.js"></script>
<script src="../../../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../../../site_libs/quarto-search/fuse.min.js"></script>
<script src="../../../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../../../">
<script src="../../../site_libs/quarto-html/quarto.js"></script>
<script src="../../../site_libs/quarto-html/popper.min.js"></script>
<script src="../../../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../../../site_libs/quarto-html/anchor.min.js"></script>
<link href="../../../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../../../site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" class="quarto-color-scheme" id="quarto-text-highlighting-styles">
<link href="../../../site_libs/quarto-html/quarto-syntax-highlighting-dark.css" rel="stylesheet" class="quarto-color-scheme quarto-color-alternate" id="quarto-text-highlighting-styles">
<script src="../../../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../../../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../../../site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" class="quarto-color-scheme" id="quarto-bootstrap" data-mode="light">
<link href="../../../site_libs/bootstrap/bootstrap-dark.min.css" rel="stylesheet" class="quarto-color-scheme quarto-color-alternate" id="quarto-bootstrap" data-mode="dark">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 20,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>


<link rel="stylesheet" href="../../../styles.css">
<meta name="twitter:title" content="Jon Minton’s Blog - The Trading Mind Game">
<meta name="twitter:description" content="">
<meta name="twitter:image" content="https://preview.redd.it/this-is-a-screenrgrab-from-carol-and-the-end-of-the-world-v0-xgjdw6i9vd9c1.jpeg?auto=webp&amp;s=d8a511e7fe850b07ae48ff087483bf9ef1635761">
<meta name="twitter:site" content="@jonminton">
<meta name="twitter:card" content="summary_large_image">
</head>

<body class="nav-fixed fullcontent">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg navbar-dark ">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container">
    <a class="navbar-brand" href="../../../index.html">
    <span class="navbar-title">Jon Minton’s Blog</span>
    </a>
  </div>
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll me-auto">
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-statistics--data-science" role="button" data-bs-toggle="dropdown" aria-expanded="false" rel="" target="">
 <span class="menu-text">Statistics &amp; Data Science</span>
    </a>
    <ul class="dropdown-menu" aria-labelledby="nav-menu-statistics--data-science">    
        <li>
    <a class="dropdown-item" href="../../../glms.html" rel="" target="">
 <span class="dropdown-text">Statistical Theory and Applications</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../../tardy-tuesday.html" rel="" target="">
 <span class="dropdown-text">Tardy Tuesday</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../../hand-drawn-statistics.html" rel="" target="">
 <span class="dropdown-text">Hand-drawn Statistics</span></a>
  </li>  
    </ul>
  </li>
</ul>
            <ul class="navbar-nav navbar-nav-scroll ms-auto">
  <li class="nav-item">
    <a class="nav-link" href="../../../unpop.html" rel="" target="">
 <span class="menu-text">Unpop</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../../about.html" rel="" target="">
 <span class="menu-text">About</span></a>
  </li>  
  <li class="nav-item compact">
    <a class="nav-link" href="https://jonminton.net" rel="" target=""><i class="bi bi-window-fullscreen" role="img">
</i> 
 <span class="menu-text"></span></a>
  </li>  
  <li class="nav-item compact">
    <a class="nav-link" href="https://github.com/JonMinton" rel="" target=""><i class="bi bi-github" role="img">
</i> 
 <span class="menu-text"></span></a>
  </li>  
  <li class="nav-item compact">
    <a class="nav-link" href="https://twitter.com/JonMinton" rel="" target=""><i class="bi bi-twitter" role="img">
</i> 
 <span class="menu-text"></span></a>
  </li>  
  <li class="nav-item compact">
    <a class="nav-link" href="https://uk.linkedin.com/in/jon-minton-09480b13a" rel="" target=""><i class="bi bi-linkedin" role="img">
</i> 
 <span class="menu-text"></span></a>
  </li>  
</ul>
            <div class="quarto-navbar-tools">
  <a href="" class="quarto-color-scheme-toggle quarto-navigation-tool  px-1" onclick="window.quartoToggleColorScheme(); return false;" title="Toggle dark mode"><i class="bi"></i></a>
</div>
          </div> <!-- /navcollapse -->
      </div> <!-- /container-fluid -->
    </nav>
</header>
<!-- content -->
<header id="title-block-header" class="quarto-title-block default page-columns page-full">
  <div class="quarto-title-banner page-columns page-full">
    <div class="quarto-title column-body">
      <h1 class="title">The Trading Mind Game</h1>
                                <div class="quarto-categories">
                <div class="quarto-category">books</div>
                <div class="quarto-category">mental health</div>
                <div class="quarto-category">inequalities</div>
                <div class="quarto-category">economics</div>
                <div class="quarto-category">distinction</div>
                <div class="quarto-category">banking</div>
              </div>
                  </div>
  </div>
    
  
  <div class="quarto-title-meta">

      <div>
      <div class="quarto-title-meta-heading">Author</div>
      <div class="quarto-title-meta-contents">
               <p>Jon Minton </p>
            </div>
    </div>
      
      <div>
      <div class="quarto-title-meta-heading">Published</div>
      <div class="quarto-title-meta-contents">
        <p class="date">March 29, 2024</p>
      </div>
    </div>
    
      
    </div>
    
  
  </header><div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
<!-- margin-sidebar -->
    
<!-- main -->
<main class="content quarto-banner-title-block" id="quarto-document-content">




<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="https://cdn.penguin.co.uk/dam-assets/books/9780241636602/9780241636602-jacket-large.jpg" class="img-fluid figure-img"></p>
<figcaption class="figure-caption">Trading Game Book Cover</figcaption>
</figure>
</div>
<blockquote class="blockquote">
<p>The Frog was shouting. Shouting and screaming. All up and wailing and arching and leaning and pacing and waving his arms. I wasn’t really listening. Every now and then I would give him a nice thoughtful nod. Just to be respectful, you know? To let him know I was with him. But really, I didn’t give a shit. He’d hauled me off to a little box room to shout at me. And it was just like I was back at school. I used to get shouted a lot at school. Being late. Not doing my homework. Talking back to teachers. Selling drugs, also. Although that only happened the once.</p>
</blockquote>
<blockquote class="blockquote">
<p>The reason I used to be late so much was that I used to have to do my paper round, and then sprint, for one and a half miles to get to school on time. And the reason I used to not do my homework was, to be honest, because I never used to have a safe space to do it. But, you know, they didn’t really give a shit about stuff like that, did they? So I used to just let them shout. And I’d look at them compassionately sometimes and I’d nod. And I’d think, well, you know, maybe it’s good for them. Maybe they’re letting something out. But mostly I’d sit with my hands on my chin and my elbows on my knees looking down on the floor, and I’d just let them shout until they’d run out of shouting. Just like I was doing right then, in that office, with The Frog. And he was shouting and screaming and wailing. And there I was with my gaze to the floor. And that’s when I noticed something for the first time. That I also had holes in my shoes.</p>
</blockquote>
<blockquote class="blockquote">
<p>There, at the outside corners of my Onitsuka Tigers, perfect symetrically, exactly where my two little toes were, were two torn holes, about two centimetres wide each. And there, flashing through them, two bright screams of colours, my two little toes, in my red Latent Orient socks. Fuck man! How long have I had these trainers? Since my first year of university. And how long had these holes been there? I didn’t even know.</p>
</blockquote>
<blockquote class="blockquote">
<p>Then I looked up. And I remembered The Frog was still shouting. And I looked him in the eyes and said, “Boss. I don’t think I can do it anymore. Boss, I think I need to quit.” And that hit The Frog sharply, like a phone to the head. And the suddenness of that make me laugh.</p>
</blockquote>
<p><a href="https://en.wikipedia.org/wiki/Gary_Stevenson_(economist)">Gary Stevenson</a> is an applied economist. And by applied I mean he learned how the economy worked (or didn’t) by working as a trader for CitiBank, and using their money (and their client’s money) to make bets about currency markets, and how the values of currencies would go up or down against each other, and at different timeframes. And these bets were informed by a broader theory about the global economy. A theory that, if true, would help make him and his employer rich. But also that, if true, would be terrible.</p>
<p>The theory was that, after the 2008 Global Financial Crisis, inequalities would keep rising. Amongst other things, this implied that interest rates would remain low relative to inflation. It seems to be these low relative interest rates that he kept betting on, from around 2009 through to 2014, as this has implications for the valuation of different foreign currency exchange (FX) swaps, meaning he was willing to make some bigger bets on some kinds of swaps than his fellow traders.</p>
<p>And from a profit perspective, the bets worked out well. According to his Wikipedia page, Stevenson become CitiBank’s most profitable trader in 2011. And this doesn’t seem to have been a fluke. In his first year, he received a bonus of almost half a million pounds, despite ‘only’ aiming for a hundred thousand. In a single year, he received more than his parents earned in decades. An amount he found stupefying, alienating, even shameful.</p>
<p><a href="https://www.penguin.co.uk/books/455809/the-trading-game-by-stevenson-gary/9780241636602">The Trading Game</a> - from which the passage above is taken - is the name of Stevenson’s first book, about his time and experiences as a trader in Citibank. It’s also the name of a particular recruitment exercise used by Citibank at the time, a card game, a bit similar to poker, which simulates some of the essentials of financial trading more generally. Stevenson won The Trading Game, and a much sought-after internship at Citibank, then a job, soon followed.</p>
<section id="the-book-grotesque-filmic-cartoonish-serious" class="level2">
<h2 class="anchored" data-anchor-id="the-book-grotesque-filmic-cartoonish-serious">The Book: Grotesque, Filmic, Cartoonish, Serious</h2>
<p>The Trading Game, the book, is grotesque. It’s also coarser, more direct, and more engaging than I was expecting, especially when read aloud by the author on Audible. It’s filmic: Imagine <em>A Beautiful Mind</em> meets <em>The Big Short</em>, as directed by Guy Ritchie, but somehow good rather than terrible. And it’s also cartoonish: Stevenson’s descriptions and pseudonyms - The Frog; The Slug; The Icicle and so on - are heightened, almost magical. One frequent observation is that most of his colleagues and bosses tend to be much larger than him, and in one memorable passages he likens them to the wagyu beef they are eating at a boozy corporate lunch: block-shaped slabs of fat marbled with muscle marbled with fat, expensive, exquisitly bred, excquisitely fed.</p>
<div class="quarto-layout-panel">
<div class="quarto-layout-row quarto-layout-valign-top">
<div class="quarto-layout-cell" style="flex-basis: 50.0%;justify-content: center;">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="https://i0.wp.com/the-art-of-autism.com/wp-content/uploads/2020/06/A-Beautiful-Mind.jpg?w=683&amp;ssl=1" class="img-fluid figure-img" alt="A Beautiful Mind"></p>
<figcaption class="figure-caption">A Beautiful Mind</figcaption>
</figure>
</div>
</div>
<div class="quarto-layout-cell" style="flex-basis: 50.0%;justify-content: center;">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="https://m.media-amazon.com/images/I/91R+bbKP4KL._AC_SL1500_.jpg" class="img-fluid figure-img" alt="The Big Short"></p>
<figcaption class="figure-caption">The Big Short</figcaption>
</figure>
</div>
</div>
</div>
</div>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="https://images.immediate.co.uk/production/volatile/sites/3/2024/02/the-gentlemen-key-art-79c5ff1.jpg?quality=90&amp;webp=true&amp;resize=1280,854" class="img-fluid figure-img" alt="Guy Ritchie's The Gentlemen"></p>
<figcaption class="figure-caption">Guy Ritchie’s The Gentlemen</figcaption>
</figure>
</div>
<p>And though it’s cartoonish, and horrible, and even fun, The Trading Game is serious, but not quite in the way I expected. I was expecting a book laden with statistics, pronouncements and denouncements about the macro stories: failing public services, insatiable corporate greed, growing structural inequaliities and the existential threat that schisms growing to chasms of privilege and opportunity have for a functioning society. And although it touches on the macro, the Trading Game is much more focused on the micro: the minutea of trading, psychology and ethnography. The Supermen of Big Finance seem, by background, a strange blend of entitled privilege and genuine meritocracy: Though having very wealthy parents makes it easier to roll the dice to have more chances to get into high earning roles, as well as to become comfortable around extreme wealth, someone who can show they have an aptitude for trading games, and so is recognised as a financial asset to the bank, will be given opportunities broadly in proportion to their abilities, even if they have humble origins.</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="https://preview.redd.it/this-is-a-screenrgrab-from-carol-and-the-end-of-the-world-v0-xgjdw6i9vd9c1.jpeg?auto=webp&amp;s=d8a511e7fe850b07ae48ff087483bf9ef1635761" class="img-fluid figure-img"></p>
<figcaption class="figure-caption">Carol and the End of the World: Similarly bleak and cartoonish</figcaption>
</figure>
</div>
<p>Cognitively, behaviourally, attitudinally, however, the Supermen of Big Finance seem selected into homogeneity. They live in a bubble of constant stress, constant egotism, a constant need to keep earning, to keep getting ever wealthier, to keep earning, and keep earning. Work is life and life is work. They might spend hundreds of pounds on three hour business lunches, might demand the finest wines and the best food, but this affluence appears to bring little joy. All of their colleagues are also their competitors, and everyone is always, everywhere, highly competitive.</p>
</section>
<section id="greed-is-compulsory" class="level2">
<h2 class="anchored" data-anchor-id="greed-is-compulsory">Greed is Compulsory</h2>
<p>Stevenson’s downfall, as a trader, came about because he wanted to stop playing. Because after earning more than a couple of seven figure bonuses he thought - like many people from outside would assume more of those inside would think - that he was already wealthy enough, and that instead of continuing to work 14 hours days he should stop. For the bank, however, he was still a highly profitable employee: a single individual bringing in as much profit as perhaps dozens or hundreds of regular employees. So, the bank wouldn’t let him leave, or at least not without him having to sacrifice most of his bonuses.</p>
<p>The bank tries the Golden Carrot, and the Barrister’s Stick, and tries to beat Stevenson down until he goes back to being a top earner. But unsurprisingly, neither kind of beating works, except at making Stevenson feel beaten down. Here, culturally dislocated to Japan, he loses motivation, is no longer the first to the office, and engages in such seditious behaviour as working officially contracted hours, going for runs, and learning the local language. Eventually, the bank realises the juice is no longer worth the squeeze, and - after being made to sign what Stevenson implies is some kind of NDA - Stevenson is finally allowed to leave.</p>
<p>As the quoted passage at the top suggests, a highly competent trader is unlikely to be a highly competent human being. Such was Stevenson’s monomaniac obsession with The Trading Game that other aspects of daily life - including buying clothes, furnishings, and staying in touch with family - all took a backseat. And while he was betting on the theory that wealth inequalities will continue to increase after the 2008 GFC, there was little time or energy spent on ruminating or attempting to ameliorate on such trends. The Trading Game turns everything into a game, even when the pawns and counters are other people’s lives and livelihoods.</p>
</section>
<section id="coda" class="level2">
<h2 class="anchored" data-anchor-id="coda">Coda</h2>
<p>Since quitting at Citigroup, Stevenson completed another degree, and became <a href="https://www.youtube.com/@garyseconomics">a social media personality and activist</a> arguing for urgent action to reduce wealth inequalities, including a return to the kinds of marginal (90%+) tax rates which the Beatles protested in the 1960s. He argues that the problems of growing inequalities have only increased since he left CitiGroup, and became greatly accelerated as a result of some of the UK government’s policies during the COVID-19 pandemic. He’s a compelling presence, both a gifted social systems thinker and communicator, and it’s in this capacity that I became aware of Stevenson. That’s why I wasn’t expecting something as earthy, personal or (and I hate to admit this) entertaining as the Trading Game turned out to be.</p>


</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const disableStylesheet = (stylesheets) => {
    for (let i=0; i < stylesheets.length; i++) {
      const stylesheet = stylesheets[i];
      stylesheet.rel = 'prefetch';
    }
  }
  const enableStylesheet = (stylesheets) => {
    for (let i=0; i < stylesheets.length; i++) {
      const stylesheet = stylesheets[i];
      stylesheet.rel = 'stylesheet';
    }
  }
  const manageTransitions = (selector, allowTransitions) => {
    const els = window.document.querySelectorAll(selector);
    for (let i=0; i < els.length; i++) {
      const el = els[i];
      if (allowTransitions) {
        el.classList.remove('notransition');
      } else {
        el.classList.add('notransition');
      }
    }
  }
  const toggleColorMode = (alternate) => {
    // Switch the stylesheets
    const alternateStylesheets = window.document.querySelectorAll('link.quarto-color-scheme.quarto-color-alternate');
    manageTransitions('#quarto-margin-sidebar .nav-link', false);
    if (alternate) {
      enableStylesheet(alternateStylesheets);
      for (const sheetNode of alternateStylesheets) {
        if (sheetNode.id === "quarto-bootstrap") {
          toggleBodyColorMode(sheetNode);
        }
      }
    } else {
      disableStylesheet(alternateStylesheets);
      toggleBodyColorPrimary();
    }
    manageTransitions('#quarto-margin-sidebar .nav-link', true);
    // Switch the toggles
    const toggles = window.document.querySelectorAll('.quarto-color-scheme-toggle');
    for (let i=0; i < toggles.length; i++) {
      const toggle = toggles[i];
      if (toggle) {
        if (alternate) {
          toggle.classList.add("alternate");     
        } else {
          toggle.classList.remove("alternate");
        }
      }
    }
    // Hack to workaround the fact that safari doesn't
    // properly recolor the scrollbar when toggling (#1455)
    if (navigator.userAgent.indexOf('Safari') > 0 && navigator.userAgent.indexOf('Chrome') == -1) {
      manageTransitions("body", false);
      window.scrollTo(0, 1);
      setTimeout(() => {
        window.scrollTo(0, 0);
        manageTransitions("body", true);
      }, 40);  
    }
  }
  const isFileUrl = () => { 
    return window.location.protocol === 'file:';
  }
  const hasAlternateSentinel = () => {  
    let styleSentinel = getColorSchemeSentinel();
    if (styleSentinel !== null) {
      return styleSentinel === "alternate";
    } else {
      return false;
    }
  }
  const setStyleSentinel = (alternate) => {
    const value = alternate ? "alternate" : "default";
    if (!isFileUrl()) {
      window.localStorage.setItem("quarto-color-scheme", value);
    } else {
      localAlternateSentinel = value;
    }
  }
  const getColorSchemeSentinel = () => {
    if (!isFileUrl()) {
      const storageValue = window.localStorage.getItem("quarto-color-scheme");
      return storageValue != null ? storageValue : localAlternateSentinel;
    } else {
      return localAlternateSentinel;
    }
  }
  let localAlternateSentinel = 'alternate';
  // Dark / light mode switch
  window.quartoToggleColorScheme = () => {
    // Read the current dark / light value 
    let toAlternate = !hasAlternateSentinel();
    toggleColorMode(toAlternate);
    setStyleSentinel(toAlternate);
  };
  // Ensure there is a toggle, if there isn't float one in the top right
  if (window.document.querySelector('.quarto-color-scheme-toggle') === null) {
    const a = window.document.createElement('a');
    a.classList.add('top-right');
    a.classList.add('quarto-color-scheme-toggle');
    a.href = "";
    a.onclick = function() { try { window.quartoToggleColorScheme(); } catch {} return false; };
    const i = window.document.createElement("i");
    i.classList.add('bi');
    a.appendChild(i);
    window.document.body.appendChild(a);
  }
  // Switch to dark mode if need be
  if (hasAlternateSentinel()) {
    toggleColorMode(true);
  } else {
    toggleColorMode(false);
  }
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
<script src="https://utteranc.es/client.js" repo="JonMinton/BlogComments" issue-term="pathname" theme="github-light" crossorigin="anonymous" async="">
</script>
</div> <!-- /content -->



</body></html>