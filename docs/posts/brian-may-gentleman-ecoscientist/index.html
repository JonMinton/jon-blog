<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.3.450">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Jon Minton">
<meta name="dcterms.date" content="2024-08-25">

<title>Jon Minton’s Blog - Brian May: Gentleman Ecoscientist</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
</style>


<script src="../../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../../site_libs/clipboard/clipboard.min.js"></script>
<script src="../../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../../site_libs/quarto-search/fuse.min.js"></script>
<script src="../../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../../">
<script src="../../site_libs/quarto-html/quarto.js"></script>
<script src="../../site_libs/quarto-html/popper.min.js"></script>
<script src="../../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../../site_libs/quarto-html/anchor.min.js"></script>
<link href="../../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../../site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" class="quarto-color-scheme" id="quarto-text-highlighting-styles">
<link href="../../site_libs/quarto-html/quarto-syntax-highlighting-dark.css" rel="stylesheet" class="quarto-color-scheme quarto-color-alternate" id="quarto-text-highlighting-styles">
<script src="../../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../../site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" class="quarto-color-scheme" id="quarto-bootstrap" data-mode="light">
<link href="../../site_libs/bootstrap/bootstrap-dark.min.css" rel="stylesheet" class="quarto-color-scheme quarto-color-alternate" id="quarto-bootstrap" data-mode="dark">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 20,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>
<script src="../../site_libs/quarto-diagram/mermaid.min.js"></script>
<script src="../../site_libs/quarto-diagram/mermaid-init.js"></script>
<link href="../../site_libs/quarto-diagram/mermaid.css" rel="stylesheet">


<link rel="stylesheet" href="../../styles.css">
<meta name="twitter:title" content="Jon Minton’s Blog - Brian May: Gentleman Ecoscientist">
<meta name="twitter:description" content="">
<meta name="twitter:image" content="may-badger.png">
<meta name="twitter:site" content="@jonminton">
<meta name="twitter:card" content="summary_large_image">
</head>

<body class="nav-fixed fullcontent">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg navbar-dark ">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container">
    <a class="navbar-brand" href="../../index.html">
    <span class="navbar-title">Jon Minton’s Blog</span>
    </a>
  </div>
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll me-auto">
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-statistics--data-science" role="button" data-bs-toggle="dropdown" aria-expanded="false" rel="" target="">
 <span class="menu-text">Statistics &amp; Data Science</span>
    </a>
    <ul class="dropdown-menu" aria-labelledby="nav-menu-statistics--data-science">    
        <li>
    <a class="dropdown-item" href="../../glms.html" rel="" target="">
 <span class="dropdown-text">Statistical Theory and Applications</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../tardy-tuesday.html" rel="" target="">
 <span class="dropdown-text">Tardy Tuesday</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../hand-drawn-statistics.html" rel="" target="">
 <span class="dropdown-text">Hand-drawn Statistics</span></a>
  </li>  
    </ul>
  </li>
</ul>
            <ul class="navbar-nav navbar-nav-scroll ms-auto">
  <li class="nav-item">
    <a class="nav-link" href="../../unpop.html" rel="" target="">
 <span class="menu-text">Unpop</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../about.html" rel="" target="">
 <span class="menu-text">About</span></a>
  </li>  
  <li class="nav-item compact">
    <a class="nav-link" href="https://jonminton.net" rel="" target=""><i class="bi bi-window-fullscreen" role="img">
</i> 
 <span class="menu-text"></span></a>
  </li>  
  <li class="nav-item compact">
    <a class="nav-link" href="https://github.com/JonMinton" rel="" target=""><i class="bi bi-github" role="img">
</i> 
 <span class="menu-text"></span></a>
  </li>  
  <li class="nav-item compact">
    <a class="nav-link" href="https://twitter.com/JonMinton" rel="" target=""><i class="bi bi-twitter" role="img">
</i> 
 <span class="menu-text"></span></a>
  </li>  
  <li class="nav-item compact">
    <a class="nav-link" href="https://uk.linkedin.com/in/jon-minton-09480b13a" rel="" target=""><i class="bi bi-linkedin" role="img">
</i> 
 <span class="menu-text"></span></a>
  </li>  
</ul>
            <div class="quarto-navbar-tools">
  <a href="" class="quarto-color-scheme-toggle quarto-navigation-tool  px-1" onclick="window.quartoToggleColorScheme(); return false;" title="Toggle dark mode"><i class="bi"></i></a>
</div>
          </div> <!-- /navcollapse -->
      </div> <!-- /container-fluid -->
    </nav>
</header>
<!-- content -->
<header id="title-block-header" class="quarto-title-block default page-columns page-full">
  <div class="quarto-title-banner page-columns page-full">
    <div class="quarto-title column-body">
      <h1 class="title">Brian May: Gentleman Ecoscientist</h1>
                                <div class="quarto-categories">
                <div class="quarto-category">epidemiology</div>
                <div class="quarto-category">television</div>
                <div class="quarto-category">science</div>
                <div class="quarto-category">agriculture</div>
              </div>
                  </div>
  </div>
    
  
  <div class="quarto-title-meta">

      <div>
      <div class="quarto-title-meta-heading">Author</div>
      <div class="quarto-title-meta-contents">
               <p>Jon Minton </p>
            </div>
    </div>
      
      <div>
      <div class="quarto-title-meta-heading">Published</div>
      <div class="quarto-title-meta-contents">
        <p class="date">August 25, 2024</p>
      </div>
    </div>
    
      
    </div>
    
  
  </header><div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
<!-- margin-sidebar -->
    
<!-- main -->
<main class="content quarto-banner-title-block" id="quarto-document-content">




<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="may-badger.png" class="img-fluid figure-img"></p>
<figcaption class="figure-caption">Brian May: The Badgers, The Farmers and Me</figcaption>
</figure>
</div>
<p>I managed to find an interesting programme on BBC iPlayer last night (not always easy): <a href="https://www.bbc.co.uk/programmes/m0022710">Brian May: The Badgers, the Farmers and me</a>. Though it contains distressing scenes, I found it much more hopeful than I was expecting.</p>
<p>Around fifteen or more years ago, Anne Brunner, a conservationist, appeared on Brian May’s property with a hedgehog, asking whether this and other rescued wild animals could be released on his property. This led, for May, to an interest in local ecology and animal welfare, and through this to particular concerns for the plight of tbe badger in England &amp; Wales.</p>
<section id="existing-transmission-model" class="level2">
<h2 class="anchored" data-anchor-id="existing-transmission-model">Existing Transmission Model</h2>
<p>In England &amp; Wales, more so in the south than the north, Bovine TB affects cattle, and through this the livelihood of farmers who raise livestock. Farmers are both mandated to conduct a skin test on their cows every 60 days and - if the test is positive for a cow - to declare the cow a ‘reactor’ and (let’s not use euphamism) kill the animal.</p>
<p>A long held belief amongst farmers and government agricultural scientists was that Bovine TB, like TB in people, is primarily a respiratory infection, and transmitted primarily through air and water.</p>
<div class="cell">
<div class="cell-output-display">
<div>
<div>
<pre class="mermaid mermaid-js">flowchart LR
reactor["Infectious cow ('Reactor')"]
s["Susceptible cow"]

reactor --air--&gt; s
reactor --water--&gt; s

</pre>
</div>
</div>
</div>
</div>
<p>However, even once all cows that test positive for TB using the standard skin test are killed, bovine TB still, sadly, often seems to recur in farms previous afflicted. This led to the assumption that another vector of infection was responsible, wild badgers, who get close to cows, share water and air with them, and so are presumed to infect them</p>
<div class="cell">
<div class="cell-output-display">
<div>
<div>
<pre class="mermaid mermaid-js">flowchart LR
cw[Cows]
reactor["Infectious cow ('Reactor')"]
r2["newly infectious cow (hidden reactor)"]
sc["Susceptible cow"]
ib["Infectious badger"]
st{"Skin test"}
cw --&gt; st
kl&gt;killed]
st --positive--&gt;reactor --&gt; kl
ib --infects--&gt; sc
st --negative--&gt;sc
sc --becomes--&gt; r2
r2 --&gt; cw

</pre>
</div>
</div>
</div>
</div>
</section>
<section id="badger-culling" class="level2">
<h2 class="anchored" data-anchor-id="badger-culling">Badger Culling</h2>
<p>Based on this transmission, it follows that culling (killing) only infectious cows isn’t enough to stop herds becoming infected. Badgers also have to be culled (killed). And because testing is expensive, and the farmers don’t own or profit from the badgers, the approach taken was to assume all badgers were <em>potentially</em> infected and infectious, and cull (kill) any found near farms ‘just in case’.</p>
<p>This mass culling (killing) of badgers was something that struck May as immensely inhumane and unfair, a presumption of guilt and imposition of a death sentence on an entire class of animal. In May’s words:</p>
<blockquote class="blockquote">
<p>As a species that inhabited Britain long before humans, and who have an equal right to be here, they are now being brutally persecuted, for a crime - I believe - they didn’t commit.</p>
</blockquote>
</section>
<section id="first-response-activism" class="level2">
<h2 class="anchored" data-anchor-id="first-response-activism">First Response: Activism</h2>
<p>Over a decade ago, May’s response was to petition vocally for the rights of badgers to exist, and for the government to change their policy regarding the culling of badgers. This brought him allies and attentions, but also set him in opposition to government, and to farmers, who both believed in the model of transmission outlined above. This approach engorged hearts that were already bleeding, but ultimately did little to change policy, and so the extent of badger culling in England &amp; Wales.</p>
</section>
<section id="second-response-scientific-research" class="level2">
<h2 class="anchored" data-anchor-id="second-response-scientific-research">Second Response: Scientific Research</h2>
<p>So, May changed tack. He sought to find flaws in the above disease transmission model, to become - in effect - an epidemiologist, and as part of this to work with farmers.</p>
<p>May’s hope was that a new disease transmission model could be demonstrated, one in which badgers do not constitute a predominant vector of transmission. Of course, hope is just that, and May is clear in stating that - even if he wrong about this - he would still oppose the mass culling of badgers on ethical grounds.</p>
</section>
<section id="approach" class="level2">
<h2 class="anchored" data-anchor-id="approach">Approach</h2>
<p>So, what did May do? He worked with a farmer, and a vet. The vet devised an <strong>enhanced test</strong>, actually a composite of three tests: the skin test currently used, and two other - more expensive (and intrusive) - tests. The suspicion was that the skin test alone was not, from a diagnostic perspective, the <strong>Gold Standard</strong> it was assumed to be: some cows who test positive may not be infected or infectious (a <em>false positive</em>), and some cows who test negative may be infected or infectious (a <em>false negative</em>). By using enhanced testing, May sought to get closer the <em>true</em> <strong>Gold Standard</strong> we might hope for (especially when a positive test is a death sentence for a cow), rather than the <strong>Fool’s Gold Standard</strong> May, and the vet, were starting to suspect the Skin Test was in reality.</p>
<p>And why does this matter? Because if there are <em>false negatives</em> in a tested herd, then there are <em>hidden reactors</em>, i.e.&nbsp;cows within the stock that, despite testing negative, are still infectious to other cows. This would mean that an apparently ‘clean’ herd, in which all apparently infectious cows have been removed, actually still contained some infectious animals, who could then infect the rest of the herd.</p>
<p>The difference in implication is massive: if the Skin Test were a <em>true</em> <strong>Gold Standard</strong> then any new infections in cows would have to be due to an <em>exogenous</em> cause (hence, badgers). If instead the Skin Test were a <strong>Fool’s Gold Standard</strong>, then the cause of new apparent infection could be <em>endogenous</em>: the cows were infecting the other cows, and no exogenous infection from badgers was needed to be assumed.</p>
<p>By performing more enhanced testing of the cows, a much higher proportion of the infectious cows (‘reactors’) were identified, and so there were far fewer reactors left in the herd to infect other cows. Sadly this of course meant more cows were killed as a result of this test in the short term, but - if the endogenous infection hypothesis were true - would mean far fewer would be killed prematurely in the longer term.</p>
<p>Using PCR tests, May and the vet were also able to successfully test for the pathogen responsible for Bovine TB, <em>M Bovis</em>, in various candidate transmission vectors. In particular, they were able to identify that cow faeces contains much higher levels of <em>M Bovis</em> than previously thought, and so that faeces was a much more potent transmission vector than previously assumed.</p>
<p>By first enhancing the tests for Bovine TB at the test farm, and then by increasing the standards of hygiene for the herd - in particular greatly reducing the scope for faecal transmission - May, the vet, and the farmer were able to <em>stop</em> transmission at the test farm within a decade.</p>
<p>A slightly unfortunate natural experiment may have also helped their case: they were unable to acquire permission to vaccinate the local wild badger population, meaning - when tested - they still carried Bovine TB. So, even though a <em>potentially</em> infectious pool of <em>M Bovis</em> still existed in the local wild badger population, the test farm itself still did not become infected.</p>
</section>
<section id="changed-model" class="level2">
<h2 class="anchored" data-anchor-id="changed-model">Changed Model</h2>
<p>In short, they had developed fairly strong evidence <em>against</em> the following transmission model:</p>
<div class="cell">
<div class="cell-output-display">
<div>
<div>
<pre class="mermaid mermaid-js">flowchart LR

badger --air--&gt; cow
badger --water--&gt; cow

</pre>
</div>
</div>
</div>
</div>
<p>And <em>for</em> the following transimission model:</p>
<div class="cell">
<div class="cell-output-display">
<div>
<div>
<pre class="mermaid mermaid-js">flowchart LR

cow --faeces--&gt; cow
cow --faeces--&gt; trough
trough --water--&gt; cow

</pre>
</div>
</div>
</div>
</div>
</section>
<section id="gentleman-ecoscientism" class="level2">
<h2 class="anchored" data-anchor-id="gentleman-ecoscientism">Gentleman Ecoscientism</h2>
<p>The epilogue of the documentary suggests that, by collecting the above evidence, running the above tests, engaging with farmers - especially skeptical and previously hostile farmers - May was successfully able to change the <em>minds</em> of those whose minds needed to be changed to prevent further mass cullings. This research took around a decade to produce, and by the sounds of it came at some substantial cost to May, both financially, and reputationally amongst those ‘<em>hearts</em>’ who had previously supported him as an activist, but were wary of his efforts to engage with those farmers that - some activists at least - saw as ‘the enemy’.</p>
<p>By the sounds of it, May’s efforts as scientist may now finally turn out to be successful, not despite but because, though motivated by <em>heart</em>, they spoke to <em>mind</em>. At the age of 77, May may now finally be successful in preventing the killing of hundreds of thousands of wild animals unnecessarily, and stopping the potential extinction of badgers in large swathes of England &amp; Wales.</p>
<p>But of course May was only able to engage in such a long-standing effort because of three things: his passion, his scientific acumen, and his wealth.</p>
<p>So, in this sense, May’s research seems almost like a return to the Gentleman Scientists of the Victorian and previous eras, a kind of atavistic return to the inequitable, but sometimes productive, roots of scientific research more generally, in which independently wealthy eccentrics devoted decades of their otherwise unstructured lives to pursuing personal interests and obsessions, with the birth of scientific journals themselves emerging as collections of correspondence between similarly minded Gentlemen Scientists, collated by elite institutions (like the Royal Society) where such (mostly) Gentlemen could meet, fraternise, and share their passions and interests with similarly minded (and well-heeled) folk.</p>
<p>I don’t know quite what to make of this from a broader socioeconomic perspective… but at least, thanks to May, the badgers’ future in England &amp; Wales is now a bit more secure!</p>


</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const disableStylesheet = (stylesheets) => {
    for (let i=0; i < stylesheets.length; i++) {
      const stylesheet = stylesheets[i];
      stylesheet.rel = 'prefetch';
    }
  }
  const enableStylesheet = (stylesheets) => {
    for (let i=0; i < stylesheets.length; i++) {
      const stylesheet = stylesheets[i];
      stylesheet.rel = 'stylesheet';
    }
  }
  const manageTransitions = (selector, allowTransitions) => {
    const els = window.document.querySelectorAll(selector);
    for (let i=0; i < els.length; i++) {
      const el = els[i];
      if (allowTransitions) {
        el.classList.remove('notransition');
      } else {
        el.classList.add('notransition');
      }
    }
  }
  const toggleColorMode = (alternate) => {
    // Switch the stylesheets
    const alternateStylesheets = window.document.querySelectorAll('link.quarto-color-scheme.quarto-color-alternate');
    manageTransitions('#quarto-margin-sidebar .nav-link', false);
    if (alternate) {
      enableStylesheet(alternateStylesheets);
      for (const sheetNode of alternateStylesheets) {
        if (sheetNode.id === "quarto-bootstrap") {
          toggleBodyColorMode(sheetNode);
        }
      }
    } else {
      disableStylesheet(alternateStylesheets);
      toggleBodyColorPrimary();
    }
    manageTransitions('#quarto-margin-sidebar .nav-link', true);
    // Switch the toggles
    const toggles = window.document.querySelectorAll('.quarto-color-scheme-toggle');
    for (let i=0; i < toggles.length; i++) {
      const toggle = toggles[i];
      if (toggle) {
        if (alternate) {
          toggle.classList.add("alternate");     
        } else {
          toggle.classList.remove("alternate");
        }
      }
    }
    // Hack to workaround the fact that safari doesn't
    // properly recolor the scrollbar when toggling (#1455)
    if (navigator.userAgent.indexOf('Safari') > 0 && navigator.userAgent.indexOf('Chrome') == -1) {
      manageTransitions("body", false);
      window.scrollTo(0, 1);
      setTimeout(() => {
        window.scrollTo(0, 0);
        manageTransitions("body", true);
      }, 40);  
    }
  }
  const isFileUrl = () => { 
    return window.location.protocol === 'file:';
  }
  const hasAlternateSentinel = () => {  
    let styleSentinel = getColorSchemeSentinel();
    if (styleSentinel !== null) {
      return styleSentinel === "alternate";
    } else {
      return false;
    }
  }
  const setStyleSentinel = (alternate) => {
    const value = alternate ? "alternate" : "default";
    if (!isFileUrl()) {
      window.localStorage.setItem("quarto-color-scheme", value);
    } else {
      localAlternateSentinel = value;
    }
  }
  const getColorSchemeSentinel = () => {
    if (!isFileUrl()) {
      const storageValue = window.localStorage.getItem("quarto-color-scheme");
      return storageValue != null ? storageValue : localAlternateSentinel;
    } else {
      return localAlternateSentinel;
    }
  }
  let localAlternateSentinel = 'alternate';
  // Dark / light mode switch
  window.quartoToggleColorScheme = () => {
    // Read the current dark / light value 
    let toAlternate = !hasAlternateSentinel();
    toggleColorMode(toAlternate);
    setStyleSentinel(toAlternate);
  };
  // Ensure there is a toggle, if there isn't float one in the top right
  if (window.document.querySelector('.quarto-color-scheme-toggle') === null) {
    const a = window.document.createElement('a');
    a.classList.add('top-right');
    a.classList.add('quarto-color-scheme-toggle');
    a.href = "";
    a.onclick = function() { try { window.quartoToggleColorScheme(); } catch {} return false; };
    const i = window.document.createElement("i");
    i.classList.add('bi');
    a.appendChild(i);
    window.document.body.appendChild(a);
  }
  // Switch to dark mode if need be
  if (hasAlternateSentinel()) {
    toggleColorMode(true);
  } else {
    toggleColorMode(false);
  }
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
<script src="https://utteranc.es/client.js" repo="JonMinton/BlogComments" issue-term="pathname" theme="github-light" crossorigin="anonymous" async="">
</script>
</div> <!-- /content -->



</body></html>