mtcars |>
mtcars |>
mutate(cyl = factor(cyl)) |>
ggplot(aes(x = wt, y = mpg, colour = cyl, group= cyl)) +
geom_point() +
stat_smooth()
mtcars |>
mutate(cyl = factor(cyl)) |>
ggplot(aes(x = wt, y = mpg, colour = cyl, group= cyl)) +
geom_point() +
stat_smooth(se = FALSE)
mtcars |>
mutate(cyl = factor(cyl)) |>
ggplot(aes(x = wt, y = mpg, colour = cyl, group= cyl)) +
geom_point() +
stat_smooth(se = FALSE, method = "lm")
mtcars |>
mutate(cyl = factor(cyl)) |>
ggplot(aes(x = wt, y = mpg, colour = cyl, group= cyl)) +
geom_point() +
stat_smooth(se = FALSE, method = "lm") +
labs(
x = "Weight",
y = "Miles per gallon"
)
mtcars |>
mutate(cyl = factor(cyl)) |>
ggplot(aes(x = wt, y = mpg, colour = cyl, group= cyl)) +
geom_point(aes(shape = cyl)) +
stat_smooth(se = FALSE, method = "lm") +
labs(
x = "Weight",
y = "Miles per gallon"
)
install.packages('pak')
library(tidyverse)
library(tidyverse)
dta <- tidytuesdayR::last_tuesday()
dta
?tidytuesdayR::last_tuesday
dta <- tidytuesdayR::tt_load( week = "2023-11-28")
?tidytuesdayR::tt_download
dta <- tidytuesdayR::tt_load(x = "2023-11-28")
View(dta)
dta_list <- tidytuesdayR::tt_load(x = "2023-11-28")
dta_eps <- dta_list[["drwho_episodes"]]
dta_eps <- dta_list[["drwho_episodes"]]
dta_wrt <- dra_list[["drwho_writers"]]
dta_wrt <- dta_list[["drwho_writers"]]
dta_eps
dta_eps |>
ggplot(aes(x = first_aired, y = uk_viewers)) +
geom_point()
dta_eps
dta_eps |>
mutate(first_ep = episode_number == 1) |>
ggplot(aes(x = first_aired, y = uk_viewers, colour = first_ep)) +
geom_point()
dta_eps |>
mutate(first_ep = episode_number == 1) |>
ggplot(aes(x = first_aired, y = uk_viewers, colour = first_ep)) +
geom_point()
dta_eps |>
mutate(first_ep = episode_number == 1) |>
ggplot(aes(x = first_aired, y = uk_viewers, colour = first_ep)) +
geom_point() +
scale_color_manual(
c(`TRUE` = "blue", `FALSE` = 'grey')
)
dta_eps |>
mutate(first_ep = episode_number == 1) |>
ggplot(aes(x = first_aired, y = uk_viewers, colour = first_ep)) +
geom_point()
dta_eps |>
ggplot(aes(x = first_aired, y = uk_viewers)) +
geom_point()
dta_eps
dta_eps_season <-
group_by(season_number) |>
mutate(mean_viewers = mean(uk_viewers)) |>
ungroup()
dta_eps |>
group_by(season_number) |>
mutate(mean_viewers = mean(uk_viewers)) |>
ungroup()
dta_eps_season |>
group_by(seas)
dta_eps_season <-
dta_eps |>
group_by(season_number) |>
mutate(mean_viewers = mean(uk_viewers)) |>
ungroup()
dta_eps_season |>
group_by(seas)
dta_eps_season |>
ggplot(aes(x = first_aired, y = uk_viewers)) +
geom_point()
dta_eps_season |>
ggplot(aes(x = first_aired, y = uk_viewers)) +
geom_point(colour = "grey")
dta_eps
dta_eps |>
group_by(season_number) |>
mutate(
mean_viewers = mean(uk_viewers),
mean_date = mean(first_aired)
) |>
ungroup()
dta_eps_season <-
dta_eps |>
group_by(season_number) |>
mutate(
mean_viewers = mean(uk_viewers),
mean_date = mean(first_aired)
) |>
ungroup()
dta_eps_season |>
ggplot(aes(x = first_aired, y = uk_viewers)) +
geom_point(colour = "grey") +
geom_point(aes(x = mean_date, y = mean_viewers), size = 1.2)
dta_eps_season |>
ggplot(aes(x = first_aired, y = uk_viewers)) +
geom_point(colour = "grey") +
geom_point(aes(x = mean_date, y = mean_viewers), size = 2.5)
dta_eps_season |>
ggplot(aes(x = first_aired, y = uk_viewers)) +
geom_point(colour = "grey") +
geom_point(aes(x = mean_date, y = mean_viewers), size = 2.5) +
labs(
x = "First aired",
y = "UK Viewers (millions)",
title = "Viewers over time for Dr Who"
) +
stat_smooth(colour = "blue", se = FALSE)
dta_eps_season |>
ggplot(aes(x = first_aired, y = uk_viewers)) +
geom_point(colour = "grey") +
geom_point(aes(x = mean_date, y = mean_viewers), size = 2.5) +
labs(
x = "First aired",
y = "UK Viewers (millions)",
title = "Viewers over time for Dr Who",
subtitle = "People don't watch TV like they used to..."
) +
stat_smooth(colour = "blue", se = FALSE)
dta_eps_season |>
ggplot(aes(x = first_aired, y = uk_viewers)) +
geom_point(colour = "grey") +
geom_point(aes(x = mean_date, y = mean_viewers), size = 2.5) +
scale_x_date(breaks = "2 years") +
labs(
x = "First aired",
y = "UK Viewers (millions)",
title = "Viewers over time for Dr Who",
subtitle = "People don't watch TV like they used to..."
) +
stat_smooth(colour = "blue", se = FALSE)
dta_eps_season |>
ggplot(aes(x = first_aired, y = uk_viewers)) +
geom_point(colour = "grey") +
geom_point(aes(x = mean_date, y = mean_viewers), size = 2.5) +
scale_x_date(breaks = "2 years", labels = \(x) format(x, "%Y")) +
labs(
x = "First aired",
y = "UK Viewers (millions)",
title = "Viewers over time for Dr Who",
subtitle = "People don't watch TV like they used to..."
) +
stat_smooth(colour = "blue", se = FALSE)
dta_eps_season |>
ggplot(aes(x = first_aired, y = uk_viewers)) +
geom_point(colour = "grey") +
geom_point(aes(x = mean_date, y = mean_viewers), size = 2.5) +
scale_x_date(breaks = "2 years", labels = \(x) format(x, "%Y")) +
labs(
x = "First aired",
y = "UK Viewers (millions)",
title = "Viewers over time for Dr Who",
subtitle = "People don't watch TV like they used to..."
) +
annotate("text", x = 2015, y = 1, label = "What happened here?!") +
stat_smooth(colour = "blue", se = FALSE)
dta_eps_season |>
ggplot(aes(x = first_aired, y = uk_viewers)) +
geom_point(colour = "grey") +
geom_point(aes(x = mean_date, y = mean_viewers), size = 2.5) +
scale_x_date(breaks = "2 years", labels = \(x) format(x, "%Y")) +
labs(
x = "First aired",
y = "UK Viewers (millions)",
title = "Viewers over time for Dr Who",
subtitle = "People don't watch TV like they used to..."
) +
annotate("text", x = year(2015), y = 1, label = "What happened here?!") +
stat_smooth(colour = "blue", se = FALSE)
dta_eps_season |>
ggplot(aes(x = first_aired, y = uk_viewers)) +
geom_point(colour = "grey") +
geom_point(aes(x = mean_date, y = mean_viewers), size = 2.5) +
scale_x_date(breaks = "2 years", labels = \(x) format(x, "%Y")) +
labs(
x = "First aired",
y = "UK Viewers (millions)",
title = "Viewers over time for Dr Who",
subtitle = "People don't watch TV like they used to..."
) +
annotate("text", x = lubridate::make_date(2015), y = 1, label = "What happened here?!") +
stat_smooth(colour = "blue", se = FALSE)
dta_eps_season |>
ggplot(aes(x = first_aired, y = uk_viewers)) +
geom_point(colour = "grey") +
geom_point(aes(x = mean_date, y = mean_viewers), size = 2.5) +
scale_x_date(breaks = "2 years", labels = \(x) format(x, "%Y")) +
labs(
x = "First aired",
y = "UK Viewers (millions)",
title = "Viewers over time for Dr Who",
subtitle = "People don't watch TV like they used to..."
) +
annotate("text", x = lubridate::make_date(2015), y = 10, label = "What happened here?!") +
stat_smooth(colour = "blue", se = FALSE)
dta_eps_season |>
ggplot(aes(x = first_aired, y = uk_viewers)) +
geom_point(colour = "grey") +
geom_point(aes(x = mean_date, y = mean_viewers), size = 2.5) +
scale_x_date(breaks = "2 years", labels = \(x) format(x, "%Y")) +
labs(
x = "First aired",
y = "UK Viewers (millions)",
title = "Viewers over time for Dr Who",
subtitle = "People don't watch TV like they used to..."
) +
annotate("text", x = lubridate::make_date(2015), y = 10, label = "What happened here?!") +
annotate("text", x = 2014, y= 7, label = "Smartphone strangling the TV from now") +
stat_smooth(colour = "blue", se = FALSE)
dta_eps_season |>
ggplot(aes(x = first_aired, y = uk_viewers)) +
geom_point(colour = "grey") +
geom_point(aes(x = mean_date, y = mean_viewers), size = 2.5) +
scale_x_date(breaks = "2 years", labels = \(x) format(x, "%Y")) +
labs(
x = "First aired",
y = "UK Viewers (millions)",
title = "Viewers over time for Dr Who",
subtitle = "People don't watch TV like they used to..."
) +
annotate("text", x = lubridate::make_date(2015), y = 10, label = "What happened here?!") +
annotate("text", x = lubridate::make_date(2014), y= 7, label = "Smartphone strangling the TV from now") +
stat_smooth(colour = "blue", se = FALSE)
?annotate
dta_eps_season |>
ggplot(aes(x = first_aired, y = uk_viewers)) +
geom_point(colour = "grey") +
geom_point(aes(x = mean_date, y = mean_viewers), size = 2.5) +
scale_x_date(breaks = "2 years", labels = \(x) format(x, "%Y")) +
labs(
x = "First aired",
y = "UK Viewers (millions)",
title = "Viewers over time for Dr Who",
subtitle = "People don't watch TV like they used to..."
) +
annotate("text", x = lubridate::make_date(2015), y = 10, label = "What happened here?!") +
annotate("text", x = lubridate::make_date(2014), y= 7, label = "Smartphone strangling the TV from now", hjust = 1) +
stat_smooth(colour = "blue", se = FALSE)
dta_eps_season |>
ggplot(aes(x = first_aired, y = uk_viewers)) +
geom_point(colour = "grey") +
geom_point(aes(x = mean_date, y = mean_viewers), size = 2.5) +
scale_x_date(breaks = "2 years", labels = \(x) format(x, "%Y")) +
labs(
x = "First aired",
y = "UK Viewers (millions)",
title = "Viewers over time for Dr Who",
subtitle = "People don't watch TV like they used to..."
) +
annotate("text", x = lubridate::make_date(2015), y = 10, label = "What happened here?!") +
annotate("text", x = lubridate::make_date(2014), y= 7, label = "Smartphone strangling the TV from now", hjust = -1) +
stat_smooth(colour = "blue", se = FALSE)
dta_eps_season |>
ggplot(aes(x = first_aired, y = uk_viewers)) +
geom_point(colour = "grey") +
geom_point(aes(x = mean_date, y = mean_viewers), size = 2.5) +
scale_x_date(breaks = "2 years", labels = \(x) format(x, "%Y")) +
labs(
x = "First aired",
y = "UK Viewers (millions)",
title = "Viewers over time for Dr Who",
subtitle = "People don't watch TV like they used to..."
) +
annotate("text", x = lubridate::make_date(2015), y = 10, label = "What happened here?!") +
annotate("text", x = lubridate::make_date(2014), y= 7, label = "Smartphone strangling the TV from now", hjust = 0.5) +
stat_smooth(colour = "blue", se = FALSE)
dta_eps_season |>
ggplot(aes(x = first_aired, y = uk_viewers)) +
geom_point(colour = "grey") +
geom_point(aes(x = mean_date, y = mean_viewers), size = 2.5) +
scale_x_date(breaks = "2 years", labels = \(x) format(x, "%Y")) +
labs(
x = "First aired",
y = "UK Viewers (millions)",
title = "Viewers over time for Dr Who",
subtitle = "People don't watch TV like they used to..."
) +
annotate("text", x = lubridate::make_date(2015), y = 10, label = "What happened here?!") +
annotate("text", x = lubridate::make_date(2014), y= 7, label = "Smartphone strangling the TV from now", hjust = 1) +
stat_smooth(colour = "blue", se = FALSE)
dta_eps_season |>
ggplot(aes(x = first_aired, y = uk_viewers)) +
geom_point(colour = "grey") +
geom_point(aes(x = mean_date, y = mean_viewers), size = 2.5) +
scale_x_date(breaks = "2 years", labels = \(x) format(x, "%Y")) +
labs(
x = "First aired",
y = "UK Viewers (millions)",
title = "Viewers over time for Dr Who",
subtitle = "People don't watch TV like they used to..."
) +
annotate("text", x = lubridate::make_date(2015), y = 10, label = "What happened here?!") +
annotate("text", x = lubridate::make_date(2014), y= 7, label = "Smartphone strangling the TV from now", hjust = 0) +
stat_smooth(colour = "blue", se = FALSE)
dta_eps_season |>
ggplot(aes(x = first_aired, y = uk_viewers)) +
geom_point(colour = "grey") +
geom_point(aes(x = mean_date, y = mean_viewers), size = 2.5) +
scale_x_date(breaks = "2 years", labels = \(x) format(x, "%Y")) +
labs(
x = "First aired",
y = "UK Viewers (millions)",
title = "Viewers over time for Dr Who",
subtitle = "People don't watch TV like they used to..."
) +
annotate("text", x = lubridate::make_date(2015), y = 10, label = "What happened here?!") +
annotate("text", x = lubridate::make_date(2014), y= 8, label = "Smartphone strangling the TV from now", hjust = 0) +
stat_smooth(colour = "blue", se = FALSE)
dta_eps
dta_wrt
dta_eps
dta_eps |>
left_join(dta_wrt, by = "story_number")
dta_eps_wrt <-
dta_eps |>
left_join(dta_wrt, by = "story_number")
dta_eps_wrt
dta_eps_wrt |>
group_by(writer) |>
summarise(
n_written = length(.)
) |>
ungroup()
dta_eps_wrt |>
group_by(writer) |>
summarise(
n_written = length(_)
) |>
ungroup()
dta_eps_wrt |>
group_by(writer) %>%
summarise(
n_written = length(.)
) |>
ungroup()
dta_eps_wrt |>
group_by(writer) %>%
summarise(
n_written = length(.)
) |>
ungroup()
dta_eps_wrt |>
group_by(writer) |>
summarise(
n_written = n()
) |>
ungroup()
dta_eps_wrt |>
group_by(writer) |>
summarise(
n_written = n()
) |>
ungroup() |>
arrange(desc(n_written))
dta_eps_wrt
dta_eps_wrt |>
ggplot(aes(x = writer, y= rating)) +
geom_boxplot()
dta_eps_wrt |>
ggplot(aes(x = writer, y= rating)) +
geom_boxplot() +
coord_flip()
dta_eps_wrt |>
ggplot(aes(x = fct_reorder(writer, rating), y= rating)) +
geom_boxplot() +
coord_flip()
dta_eps_wrt |>
group_by(writer) |>
summarise(
n_written = n()
) |>
ungroup() |>
filter(n_written >= 5) |>
ggplot(aes(x = fct_reorder(writer, rating), y= rating)) +
geom_boxplot() +
coord_flip()
dta_eps_wrt |>
group_by(writer) |>
mutate(
n_written = n()
) |>
ungroup()
dta_eps_wrt |>
group_by(writer) |>
mutate(
n_written = n()
) |>
ungroup() |>
filter(n_written >= 5) |>
ggplot(aes(x = fct_reorder(writer, rating), y= rating)) +
geom_boxplot() +
coord_flip()
dta_eps_wrt |>
group_by(writer) |>
mutate(
n_written = n()
) |>
ungroup() |>
filter(n_written >= 5) |>
ggplot(aes(x = fct_reorder(writer, rating), y= rating)) +
geom_boxplot() +
coord_flip() +
labs(
x = "Distribution of ratings",
y = "Writer",
title = "Rating distribution by writer",
subtitle = "Writers who wrote at least five episodes"
)
dta_eps_wrt
dta_eps_wrt |>
group_by(writer) |>
summarise(
started_writing = min(first_aired),
finished_writing = max(first_aired)
)
dta_eps_wrt |>
group_by(writer) |>
summarise(
started_writing = min(first_aired),
finished_writing = max(first_aired)
) |>
ungroup() |>
mutate(
yr_start = year(started_writing),
yr_end = year(finished_writing)
)
dta_eps_wrt
dta_eps_wrt |>
group_by(writer) |>
mutate(
n_written = n()
) |>
ungroup() |>
filter(n_written >= 5) |>
group_by(writer) |>
summarise(
started_writing = min(first_aired),
finished_writing = max(first_aired)
) |>
ungroup() |>
mutate(
yr_start = year(started_writing),
yr_end = year(finished_writing)
)
major_writers_active <-
dta_eps_wrt |>
group_by(writer) |>
mutate(
n_written = n()
) |>
ungroup() |>
filter(n_written >= 5) |>
group_by(writer) |>
summarise(
started_writing = min(first_aired),
finished_writing = max(first_aired)
) |>
ungroup() |>
mutate(
yr_start = year(started_writing),
yr_end = year(finished_writing)
)
major_writers_active
major_writers_active |>
arrange(started_writing)
major_writers_active <-
dta_eps_wrt |>
group_by(writer) |>
mutate(
n_written = n()
) |>
ungroup() |>
filter(n_written >= 5) |>
group_by(writer) |>
summarise(
started_writing = min(first_aired),
finished_writing = max(first_aired),
n_written = n_written[1]
) |>
ungroup() |>
mutate(
yr_start = year(started_writing),
yr_end = year(finished_writing)
)
major_writers_active |>
arrange(started_writing)
