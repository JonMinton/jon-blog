geom_point(aes(x = mean_date, y = mean_viewers), size = 2.5) +
scale_x_date(breaks = "2 years", labels = \(x) format(x, "%Y")) +
labs(
x = "First aired",
y = "UK Viewers (millions)",
title = "Viewers over time for Dr Who",
subtitle = "People don't watch TV like they used to..."
) +
annotate("text", x = lubridate::make_date(2015), y = 10, label = "What happened here?!") +
annotate("text", x = lubridate::make_date(2014), y= 7, label = "Smartphone strangling the TV from now", hjust = 1) +
stat_smooth(colour = "blue", se = FALSE)
dta_eps_season |>
ggplot(aes(x = first_aired, y = uk_viewers)) +
geom_point(colour = "grey") +
geom_point(aes(x = mean_date, y = mean_viewers), size = 2.5) +
scale_x_date(breaks = "2 years", labels = \(x) format(x, "%Y")) +
labs(
x = "First aired",
y = "UK Viewers (millions)",
title = "Viewers over time for Dr Who",
subtitle = "People don't watch TV like they used to..."
) +
annotate("text", x = lubridate::make_date(2015), y = 10, label = "What happened here?!") +
annotate("text", x = lubridate::make_date(2014), y= 7, label = "Smartphone strangling the TV from now", hjust = -1) +
stat_smooth(colour = "blue", se = FALSE)
dta_eps_season |>
ggplot(aes(x = first_aired, y = uk_viewers)) +
geom_point(colour = "grey") +
geom_point(aes(x = mean_date, y = mean_viewers), size = 2.5) +
scale_x_date(breaks = "2 years", labels = \(x) format(x, "%Y")) +
labs(
x = "First aired",
y = "UK Viewers (millions)",
title = "Viewers over time for Dr Who",
subtitle = "People don't watch TV like they used to..."
) +
annotate("text", x = lubridate::make_date(2015), y = 10, label = "What happened here?!") +
annotate("text", x = lubridate::make_date(2014), y= 7, label = "Smartphone strangling the TV from now", hjust = 0.5) +
stat_smooth(colour = "blue", se = FALSE)
dta_eps_season |>
ggplot(aes(x = first_aired, y = uk_viewers)) +
geom_point(colour = "grey") +
geom_point(aes(x = mean_date, y = mean_viewers), size = 2.5) +
scale_x_date(breaks = "2 years", labels = \(x) format(x, "%Y")) +
labs(
x = "First aired",
y = "UK Viewers (millions)",
title = "Viewers over time for Dr Who",
subtitle = "People don't watch TV like they used to..."
) +
annotate("text", x = lubridate::make_date(2015), y = 10, label = "What happened here?!") +
annotate("text", x = lubridate::make_date(2014), y= 7, label = "Smartphone strangling the TV from now", hjust = 1) +
stat_smooth(colour = "blue", se = FALSE)
dta_eps_season |>
ggplot(aes(x = first_aired, y = uk_viewers)) +
geom_point(colour = "grey") +
geom_point(aes(x = mean_date, y = mean_viewers), size = 2.5) +
scale_x_date(breaks = "2 years", labels = \(x) format(x, "%Y")) +
labs(
x = "First aired",
y = "UK Viewers (millions)",
title = "Viewers over time for Dr Who",
subtitle = "People don't watch TV like they used to..."
) +
annotate("text", x = lubridate::make_date(2015), y = 10, label = "What happened here?!") +
annotate("text", x = lubridate::make_date(2014), y= 7, label = "Smartphone strangling the TV from now", hjust = 0) +
stat_smooth(colour = "blue", se = FALSE)
dta_eps_season |>
ggplot(aes(x = first_aired, y = uk_viewers)) +
geom_point(colour = "grey") +
geom_point(aes(x = mean_date, y = mean_viewers), size = 2.5) +
scale_x_date(breaks = "2 years", labels = \(x) format(x, "%Y")) +
labs(
x = "First aired",
y = "UK Viewers (millions)",
title = "Viewers over time for Dr Who",
subtitle = "People don't watch TV like they used to..."
) +
annotate("text", x = lubridate::make_date(2015), y = 10, label = "What happened here?!") +
annotate("text", x = lubridate::make_date(2014), y= 8, label = "Smartphone strangling the TV from now", hjust = 0) +
stat_smooth(colour = "blue", se = FALSE)
dta_eps
dta_wrt
dta_eps
dta_eps |>
left_join(dta_wrt, by = "story_number")
dta_eps_wrt <-
dta_eps |>
left_join(dta_wrt, by = "story_number")
dta_eps_wrt
dta_eps_wrt |>
group_by(writer) |>
summarise(
n_written = length(.)
) |>
ungroup()
dta_eps_wrt |>
group_by(writer) |>
summarise(
n_written = length(_)
) |>
ungroup()
dta_eps_wrt |>
group_by(writer) %>%
summarise(
n_written = length(.)
) |>
ungroup()
dta_eps_wrt |>
group_by(writer) %>%
summarise(
n_written = length(.)
) |>
ungroup()
dta_eps_wrt |>
group_by(writer) |>
summarise(
n_written = n()
) |>
ungroup()
dta_eps_wrt |>
group_by(writer) |>
summarise(
n_written = n()
) |>
ungroup() |>
arrange(desc(n_written))
dta_eps_wrt
dta_eps_wrt |>
ggplot(aes(x = writer, y= rating)) +
geom_boxplot()
dta_eps_wrt |>
ggplot(aes(x = writer, y= rating)) +
geom_boxplot() +
coord_flip()
dta_eps_wrt |>
ggplot(aes(x = fct_reorder(writer, rating), y= rating)) +
geom_boxplot() +
coord_flip()
dta_eps_wrt |>
group_by(writer) |>
summarise(
n_written = n()
) |>
ungroup() |>
filter(n_written >= 5) |>
ggplot(aes(x = fct_reorder(writer, rating), y= rating)) +
geom_boxplot() +
coord_flip()
dta_eps_wrt |>
group_by(writer) |>
mutate(
n_written = n()
) |>
ungroup()
dta_eps_wrt |>
group_by(writer) |>
mutate(
n_written = n()
) |>
ungroup() |>
filter(n_written >= 5) |>
ggplot(aes(x = fct_reorder(writer, rating), y= rating)) +
geom_boxplot() +
coord_flip()
dta_eps_wrt |>
group_by(writer) |>
mutate(
n_written = n()
) |>
ungroup() |>
filter(n_written >= 5) |>
ggplot(aes(x = fct_reorder(writer, rating), y= rating)) +
geom_boxplot() +
coord_flip() +
labs(
x = "Distribution of ratings",
y = "Writer",
title = "Rating distribution by writer",
subtitle = "Writers who wrote at least five episodes"
)
dta_eps_wrt
dta_eps_wrt |>
group_by(writer) |>
summarise(
started_writing = min(first_aired),
finished_writing = max(first_aired)
)
dta_eps_wrt |>
group_by(writer) |>
summarise(
started_writing = min(first_aired),
finished_writing = max(first_aired)
) |>
ungroup() |>
mutate(
yr_start = year(started_writing),
yr_end = year(finished_writing)
)
dta_eps_wrt
dta_eps_wrt |>
group_by(writer) |>
mutate(
n_written = n()
) |>
ungroup() |>
filter(n_written >= 5) |>
group_by(writer) |>
summarise(
started_writing = min(first_aired),
finished_writing = max(first_aired)
) |>
ungroup() |>
mutate(
yr_start = year(started_writing),
yr_end = year(finished_writing)
)
major_writers_active <-
dta_eps_wrt |>
group_by(writer) |>
mutate(
n_written = n()
) |>
ungroup() |>
filter(n_written >= 5) |>
group_by(writer) |>
summarise(
started_writing = min(first_aired),
finished_writing = max(first_aired)
) |>
ungroup() |>
mutate(
yr_start = year(started_writing),
yr_end = year(finished_writing)
)
major_writers_active
major_writers_active |>
arrange(started_writing)
major_writers_active <-
dta_eps_wrt |>
group_by(writer) |>
mutate(
n_written = n()
) |>
ungroup() |>
filter(n_written >= 5) |>
group_by(writer) |>
summarise(
started_writing = min(first_aired),
finished_writing = max(first_aired),
n_written = n_written[1]
) |>
ungroup() |>
mutate(
yr_start = year(started_writing),
yr_end = year(finished_writing)
)
major_writers_active |>
arrange(started_writing)
?curve
lgt <- function(x) {1 / (1 + exp(-x))}
curve(lgt, -5, 5)
curve(lgt, -6, 6)
curve(lgt, -6, 6,
xlab = "x (before transform)",
ylab = "z (after transform)"
)
curve(lgt, -6, 6,
xlab = "x (before transform)",
ylab = "z (after transform)",
title = "The Logistic Transformation"
)
curve(lgt, -6, 6,
xlab = "x (before transform)",
ylab = "z (after transform)",
main = "The Logistic Transformation"
)
curve(ident, -6, 6,
xlab = "x (before transform)",
ylab = "z (after transform)",
main = "The Identity 'Transformation'"
)
ident <- function(x) {x}
curve(ident, -6, 6,
xlab = "x (before transform)",
ylab = "z (after transform)",
main = "The Identity 'Transformation'"
)
data(iris)
View(iris)
iris |>
ggplot(aes(Sepal.Width, Sepal.Length)) +
geom_point()
library(tidyverse)
iris |>
ggplot(aes(Sepal.Width, Sepal.Length)) +
geom_point()
iris |>
ggplot(aes(Petal.Length, Sepal.Length)) +
geom_point()
iris |>
ggplot(aes(Petal.Length, Sepal.Length)) +
geom_point() +
labs(
title = "The Iris dataset *Yawn*",
x = "Petal Length",
y = "Sepal Length"
)
iris |>
ggplot(aes(Petal.Length, Sepal.Length)) +
geom_point() +
labs(
title = "The Iris dataset *Yawn*",
x = "Petal Length",
y = "Sepal Length"
) +
expand_limits(x = 0, y = 0)
iris |>
filter(Petal.length > 2.5) |>
ggplot(aes(Petal.Length, Sepal.Length)) +
geom_point() +
labs(
title = "The Iris dataset *Yawn*",
x = "Petal Length",
y = "Sepal Length"
) +
expand_limits(x = 0, y = 0)
library(tidyverse)
iris |>
filter(Petal.length > 2.5) |>
ggplot(aes(Petal.Length, Sepal.Length)) +
geom_point() +
labs(
title = "The Iris dataset *Yawn*",
x = "Petal Length",
y = "Sepal Length"
) +
expand_limits(x = 0, y = 0)
iris |>
filter(Petal.length > 2.5) |>
ggplot(aes(Petal.Length, Sepal.Length)) +
geom_point() +
labs(
title = "The Iris dataset *Yawn*",
x = "Petal Length",
y = "Sepal Length"
) +
expand_limits(x = 0, y = 0)
iris |>
filter(Petal.Length > 2.5) |>
ggplot(aes(Petal.Length, Sepal.Length)) +
geom_point() +
labs(
title = "The Iris dataset *Yawn*",
x = "Petal Length",
y = "Sepal Length"
) +
expand_limits(x = 0, y = 0)
iris_ss <-
iris |>
filter(Petal.Length > 2.5)
mod_lm <- lm(Sepal.Length ~ Petal.Length, data = iris_ss)
summary(mod_lm)
mod_glm <- glm(Sepal.Length ~ Petal.Length, data = iris_ss)
summary(mod_glm)
?glm
summary.glm(mod_glm)
summary.lm(mod_glm)
class(mod_glm)
0.1 / 12
exp(-12)
exp(-12) * (1.1)
exp(-12) * (1.1) - 1
exp(1/12)
exp(-12)
-exp(12)
1/ exp(12)
1/ exp(-12)
exp(1/12)
exp(1/12)*1.10
1.1^(1/12)
1.1^(1/12) - 1
curve(convert_to_monthly, 0, 0.12)
convert_to_monthly <- function(x) {(1 + x)^(1/12) - 1}
curve(convert_to_monthly, 0, 0.12)
df |>
ggplot(aes(ry, rm)) +
geom_line() +
coord_equal()
library(tidyverse)
convert_to_monthly <- function(x) {(1 + x)^(1/12) - 1}
df <-
tibble(
ry = seq(0, 0.12, by = 0.001)
) |>
mutate(rm = convert_to_monthly(ry)
df |>
library(tidyverse)
convert_to_monthly <- function(x) {(1 + x)^(1/12) - 1}
df <-
tibble(
ry = seq(0, 0.12, by = 0.001)
) |>
mutate(rm = convert_to_monthly(ry))
df |>
ggplot(aes(ry, rm)) +
geom_line() +
coord_equal()
library(tidyverse)
df <- tribble(
~option, ~month, ~amount,
"A", 0, 150,
"A", 1, 0,
"A", 2, 0,
"A", 3, 0,
"B", 0, 0,
"B", 1, 50,
"B", 2, 50,
"B", 3, 50
)
library(tidyverse)
df <- tribble(
~option, ~month, ~amount,
"A", 0, 150,
"A", 1, 0,
"A", 2, 0,
"A", 3, 0,
"B", 0, 0,
"B", 1, 50,
"B", 2, 50,
"B", 3, 50
)
df |>
ggplot(aes(month, amount)) +
geom_col() +
facet_wrap(~ option, nrow = 2)
annual_to_monthly <- function(x) {(1 + x)^(1/12) -1}
annual_inflation <- 0.10
monthly_inflation <- annual_to_monthly(annual_inflation)
annual_to_monthly <- function(x) {(1 + x)^(1/12) -1}
annual_inflation <- 0.10
monthly_inflation <- annual_to_monthly(annual_inflation)
index0 <- 1
index1 <- index0 / (1 + monthly_inflation)
index2 <- index1 / (1 + monthly_inflation)
index3 <- index2 / (1 + monthly_inflation)
df <- tibble(
month = 0:3,
index = c(index0, index1, index2, index3)
)
df
df2 <- df |>
mutate(
amount = c(0, 50, 50, 50)
) |>
mutate(npv_amount = amount * index)
df2
df2$npv_amount |> sum()
(df2$npv_amount |> sum() ) / 150
1 - (df2$npv_amount |> sum() ) / 150
calc_npv_discount <- function(ry) {
annual_to_monthly <- function(x) {(1 + x)^(1/12) -1}
rm <- annual_to_monthly(ry)
index0 <- 1
index1 <- index0 / (1 + rm)
index2 <- index1 / (1 + rm)
index3 <- index2 / (1 + rm)
npv_amt1 <- (1/3) * index1
npv_amt2 <- (1/3) * index2
npv_amt3 <- (1/3) * index3
sum(npv_amt1, npv_amt2, npv_amt3)
}
calc_npv_discount(0.1)
calc_npv_discount <- function(ry) {
annual_to_monthly <- function(x) {(1 + x)^(1/12) -1}
rm <- annual_to_monthly(ry)
index0 <- 1
index1 <- index0 / (1 + rm)
index2 <- index1 / (1 + rm)
index3 <- index2 / (1 + rm)
npv_amt1 <- (1/3) * index1
npv_amt2 <- (1/3) * index2
npv_amt3 <- (1/3) * index3
1 - sum(npv_amt1, npv_amt2, npv_amt3)
}
calc_npv_discount(0.1)
df |>
ggplot(aes(annual_rate, effective_discount)) +
geom_line()
calc_npv_discount <- function(ry) {
annual_to_monthly <- function(x) {(1 + x)^(1/12) -1}
rm <- annual_to_monthly(ry)
index0 <- 1
index1 <- index0 / (1 + rm)
index2 <- index1 / (1 + rm)
index3 <- index2 / (1 + rm)
npv_amt1 <- (1/3) * index1
npv_amt2 <- (1/3) * index2
npv_amt3 <- (1/3) * index3
1 - sum(npv_amt1, npv_amt2, npv_amt3)
}
df <-
tibble(
annual_rate = seq(0, 0.12, by = 0.01)
) |>
mutate(
effective_discount = calc_npv_discount(annual_rate)
)
df |>
ggplot(aes(annual_rate, effective_discount)) +
geom_line()
df
