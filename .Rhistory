annotate("segment", x = 0, xend = 100 * 0.148, colour = "lightblue", y = 100 * calc_npv_discount(0.148), yend = 100 * calc_npv_discount(0.148)) +
annotate("text",
x = 2, y = 100 * calc_npv_discount(0.148),
label = "Goods"
) +
annotate("segment", x = 9.6, xend = 9.6, colour = "darkblue", y = 0, yend = 100 * calc_npv_discount(0.096)) +
annotate("segment", x = 0, xend = 100 * 0.096, colour = "darkblue", y = 100 * calc_npv_discount(0.096), yend = 100 * calc_npv_discount(0.096)) +
annotate("segment", x = 5.3, xend = 5.3, colour = "darkgrey", y = 0, yend = 100 * calc_npv_discount(0.053)) +
annotate("segment", x = 0, xend = 100 * 0.053, colour = "darkgrey", y = 100 * calc_npv_discount(0.053), yend = 100 * calc_npv_discount(0.053))
df |>
ggplot(aes(100 * annual_rate, 100 * effective_discount)) +
geom_line() +
labs(x = "Annual inflation rate (%)",
y = "Effective discount on paying over 3 months (%)",
title = "Effective short-term discount rate against inflation rate"
) +
annotate("segment", x = 14.8, xend = 14.8, colour = "lightblue", y = 0, yend = 100 * calc_npv_discount(0.148)) +
annotate("segment", x = 0, xend = 100 * 0.148, colour = "lightblue", y = 100 * calc_npv_discount(0.148), yend = 100 * calc_npv_discount(0.148)) +
annotate("text",
x = 2, y = 1.5 + 100 * calc_npv_discount(0.148),
label = "Goods"
) +
annotate("segment", x = 9.6, xend = 9.6, colour = "darkblue", y = 0, yend = 100 * calc_npv_discount(0.096)) +
annotate("segment", x = 0, xend = 100 * 0.096, colour = "darkblue", y = 100 * calc_npv_discount(0.096), yend = 100 * calc_npv_discount(0.096)) +
annotate("segment", x = 5.3, xend = 5.3, colour = "darkgrey", y = 0, yend = 100 * calc_npv_discount(0.053)) +
annotate("segment", x = 0, xend = 100 * 0.053, colour = "darkgrey", y = 100 * calc_npv_discount(0.053), yend = 100 * calc_npv_discount(0.053))
df |>
ggplot(aes(100 * annual_rate, 100 * effective_discount)) +
geom_line() +
labs(x = "Annual inflation rate (%)",
y = "Effective discount on paying over 3 months (%)",
title = "Effective short-term discount rate against inflation rate"
) +
annotate("segment", x = 14.8, xend = 14.8, colour = "lightblue", y = 0, yend = 100 * calc_npv_discount(0.148)) +
annotate("segment", x = 0, xend = 100 * 0.148, colour = "lightblue", y = 100 * calc_npv_discount(0.148), yend = 100 * calc_npv_discount(0.148)) +
annotate("text",
x = 2, y = 0.1 + 100 * calc_npv_discount(0.148),
label = "Goods"
) +
annotate("segment", x = 9.6, xend = 9.6, colour = "darkblue", y = 0, yend = 100 * calc_npv_discount(0.096)) +
annotate("segment", x = 0, xend = 100 * 0.096, colour = "darkblue", y = 100 * calc_npv_discount(0.096), yend = 100 * calc_npv_discount(0.096)) +
annotate("segment", x = 5.3, xend = 5.3, colour = "darkgrey", y = 0, yend = 100 * calc_npv_discount(0.053)) +
annotate("segment", x = 0, xend = 100 * 0.053, colour = "darkgrey", y = 100 * calc_npv_discount(0.053), yend = 100 * calc_npv_discount(0.053))
df |>
ggplot(aes(100 * annual_rate, 100 * effective_discount)) +
geom_line() +
labs(x = "Annual inflation rate (%)",
y = "Effective discount on paying over 3 months (%)",
title = "Effective short-term discount rate against inflation rate"
) +
annotate("segment", x = 14.8, xend = 14.8, colour = "lightblue", y = 0, yend = 100 * calc_npv_discount(0.148)) +
annotate("segment", x = 0, xend = 100 * 0.148, colour = "lightblue", y = 100 * calc_npv_discount(0.148), yend = 100 * calc_npv_discount(0.148)) +
annotate("text",
x = 2, y = 0.1 + 100 * calc_npv_discount(0.148),
label = "Goods (Highest)"
) +
annotate("segment", x = 9.6, xend = 9.6, colour = "darkblue", y = 0, yend = 100 * calc_npv_discount(0.096)) +
annotate("segment", x = 0, xend = 100 * 0.096, colour = "darkblue", y = 100 * calc_npv_discount(0.096), yend = 100 * calc_npv_discount(0.096)) +
annotate("text",
x = 2, y = 0.1 + 100 * calc_npv_discount(0.096),
label = "CPHI (Highest)"
) +
annotate("segment", x = 5.3, xend = 5.3, colour = "darkgrey", y = 0, yend = 100 * calc_npv_discount(0.053)) +
annotate("segment", x = 0, xend = 100 * 0.053, colour = "darkgrey", y = 100 * calc_npv_discount(0.053), yend = 100 * calc_npv_discount(0.053))
df |>
ggplot(aes(100 * annual_rate, 100 * effective_discount)) +
geom_line() +
labs(x = "Annual inflation rate (%)",
y = "Effective discount on paying over 3 months (%)",
title = "Effective short-term discount rate against inflation rate"
) +
annotate("segment", x = 14.8, xend = 14.8, colour = "lightblue", y = 0, yend = 100 * calc_npv_discount(0.148)) +
annotate("segment", x = 0, xend = 100 * 0.148, colour = "lightblue", y = 100 * calc_npv_discount(0.148), yend = 100 * calc_npv_discount(0.148)) +
annotate("text",
x = 2, y = 0.1 + 100 * calc_npv_discount(0.148),
label = "Goods (Highest)"
) +
annotate("segment", x = 9.6, xend = 9.6, colour = "darkblue", y = 0, yend = 100 * calc_npv_discount(0.096)) +
annotate("segment", x = 0, xend = 100 * 0.096, colour = "darkblue", y = 100 * calc_npv_discount(0.096), yend = 100 * calc_npv_discount(0.096)) +
annotate("text",
x = 2, y = 0.1 + 100 * calc_npv_discount(0.096),
label = "CPHI (Highest)"
) +
annotate("segment", x = 5.3, xend = 5.3, colour = "darkgrey", y = 0, yend = 100 * calc_npv_discount(0.053)) +
annotate("segment", x = 0, xend = 100 * 0.053, colour = "darkgrey", y = 100 * calc_npv_discount(0.053), yend = 100 * calc_npv_discount(0.053)) +
annotate("text",
x = 2, y = 0.1 + 100 * calc_npv_discount(0.053),
label = "Services"
)
df |>
ggplot(aes(100 * annual_rate, 100 * effective_discount)) +
geom_line() +
labs(x = "Annual inflation rate (%)",
y = "Effective discount on paying over 3 months (%)",
title = "Effective short-term discount rate against inflation rate"
) +
annotate("segment", x = 14.8, xend = 14.8, colour = "lightblue", y = 0, yend = 100 * calc_npv_discount(0.148)) +
annotate("segment", x = 0, xend = 100 * 0.148, colour = "lightblue", y = 100 * calc_npv_discount(0.148), yend = 100 * calc_npv_discount(0.148)) +
annotate("text",
x = 2, y = 0.1 + 100 * calc_npv_discount(0.148),
label = "Goods (Highest)"
) +
annotate("segment", x = 9.6, xend = 9.6, colour = "darkblue", y = 0, yend = 100 * calc_npv_discount(0.096)) +
annotate("segment", x = 0, xend = 100 * 0.096, colour = "darkblue", y = 100 * calc_npv_discount(0.096), yend = 100 * calc_npv_discount(0.096)) +
annotate("text",
x = 2, y = 0.1 + 100 * calc_npv_discount(0.096),
label = "CPHI (Highest)"
) +
annotate("segment", x = 5.3, xend = 5.3, colour = "darkgrey", y = 0, yend = 100 * calc_npv_discount(0.053)) +
annotate("segment", x = 0, xend = 100 * 0.053, colour = "darkgrey", y = 100 * calc_npv_discount(0.053), yend = 100 * calc_npv_discount(0.053)) +
annotate("text",
x = 2, y = 0.1 + 100 * calc_npv_discount(0.053),
label = "Services (Highest)"
)
df |>
ggplot(aes(100 * annual_rate, 100 * effective_discount)) +
geom_line() +
labs(x = "Annual inflation rate (%)",
y = "Effective discount on paying over 3 months (%)",
title = "Effective short-term discount rate against inflation rate"
) +
scale_y_continuous(breaks = c(0, 15, by = 0.1)) +
annotate("segment", x = 14.8, xend = 14.8, colour = "lightblue", y = 0, yend = 100 * calc_npv_discount(0.148)) +
annotate("segment", x = 0, xend = 100 * 0.148, colour = "lightblue", y = 100 * calc_npv_discount(0.148), yend = 100 * calc_npv_discount(0.148)) +
annotate("text",
x = 2, y = 0.1 + 100 * calc_npv_discount(0.148),
label = "Goods (Highest)"
) +
annotate("segment", x = 9.6, xend = 9.6, colour = "darkblue", y = 0, yend = 100 * calc_npv_discount(0.096)) +
annotate("segment", x = 0, xend = 100 * 0.096, colour = "darkblue", y = 100 * calc_npv_discount(0.096), yend = 100 * calc_npv_discount(0.096)) +
annotate("text",
x = 2, y = 0.1 + 100 * calc_npv_discount(0.096),
label = "CPHI (Highest)"
) +
annotate("segment", x = 5.3, xend = 5.3, colour = "darkgrey", y = 0, yend = 100 * calc_npv_discount(0.053)) +
annotate("segment", x = 0, xend = 100 * 0.053, colour = "darkgrey", y = 100 * calc_npv_discount(0.053), yend = 100 * calc_npv_discount(0.053)) +
annotate("text",
x = 2, y = 0.1 + 100 * calc_npv_discount(0.053),
label = "Services (Highest)"
)
df |>
ggplot(aes(100 * annual_rate, 100 * effective_discount)) +
geom_line() +
labs(x = "Annual inflation rate (%)",
y = "Effective discount on paying over 3 months (%)",
title = "Effective short-term discount rate against inflation rate"
) +
scale_y_continuous(breaks = seq(0, 15, by = 0.1)) +
annotate("segment", x = 14.8, xend = 14.8, colour = "lightblue", y = 0, yend = 100 * calc_npv_discount(0.148)) +
annotate("segment", x = 0, xend = 100 * 0.148, colour = "lightblue", y = 100 * calc_npv_discount(0.148), yend = 100 * calc_npv_discount(0.148)) +
annotate("text",
x = 2, y = 0.1 + 100 * calc_npv_discount(0.148),
label = "Goods (Highest)"
) +
annotate("segment", x = 9.6, xend = 9.6, colour = "darkblue", y = 0, yend = 100 * calc_npv_discount(0.096)) +
annotate("segment", x = 0, xend = 100 * 0.096, colour = "darkblue", y = 100 * calc_npv_discount(0.096), yend = 100 * calc_npv_discount(0.096)) +
annotate("text",
x = 2, y = 0.1 + 100 * calc_npv_discount(0.096),
label = "CPHI (Highest)"
) +
annotate("segment", x = 5.3, xend = 5.3, colour = "darkgrey", y = 0, yend = 100 * calc_npv_discount(0.053)) +
annotate("segment", x = 0, xend = 100 * 0.053, colour = "darkgrey", y = 100 * calc_npv_discount(0.053), yend = 100 * calc_npv_discount(0.053)) +
annotate("text",
x = 2, y = 0.1 + 100 * calc_npv_discount(0.053),
label = "Services (Highest)"
)
df |>
ggplot(aes(100 * annual_rate, 100 * effective_discount)) +
geom_line() +
labs(x = "Annual inflation rate (%)",
y = "Effective discount on paying over 3 months (%)",
title = "Effective short-term discount rate against inflation rate"
) +
scale_y_continuous(breaks = seq(0, 15, by = 0.1)) +
annotate("segment", x = 14.8, xend = 14.8, colour = "lightblue", y = 0, yend = 100 * calc_npv_discount(0.148)) +
annotate("segment", x = 0, xend = 100 * 0.148, colour = "lightblue", y = 100 * calc_npv_discount(0.148), yend = 100 * calc_npv_discount(0.148)) +
annotate("text",
x = 2, y = 0.1 + 100 * calc_npv_discount(0.148),
label = "Goods (Highest)"
) +
annotate("segment", x = 9.6, xend = 9.6, colour = "darkblue", y = 0, yend = 100 * calc_npv_discount(0.096)) +
annotate("segment", x = 0, xend = 100 * 0.096, colour = "darkblue", y = 100 * calc_npv_discount(0.096), yend = 100 * calc_npv_discount(0.096)) +
annotate("text",
x = 2, y = 0.1 + 100 * calc_npv_discount(0.096),
label = "CPIH (Highest)"
) +
annotate("segment", x = 5.3, xend = 5.3, colour = "darkgrey", y = 0, yend = 100 * calc_npv_discount(0.053)) +
annotate("segment", x = 0, xend = 100 * 0.053, colour = "darkgrey", y = 100 * calc_npv_discount(0.053), yend = 100 * calc_npv_discount(0.053)) +
annotate("text",
x = 2, y = 0.1 + 100 * calc_npv_discount(0.053),
label = "Services (Highest)"
)
gg |>
annotate("segment", x = 2.9, xend = 2.9, colour = "lightblue", linetype = "dashed" y = 0, yend = 100 * calc_npv_discount(0.029)) +
gg <-
df |>
ggplot(aes(100 * annual_rate, 100 * effective_discount)) +
geom_line() +
labs(x = "Annual inflation rate (%)",
y = "Effective discount on paying over 3 months (%)",
title = "Effective short-term discount rate against inflation rate"
) +
scale_y_continuous(breaks = seq(0, 15, by = 0.1)) +
annotate("segment", x = 14.8, xend = 14.8, colour = "lightblue", y = 0, yend = 100 * calc_npv_discount(0.148)) +
annotate("segment", x = 0, xend = 100 * 0.148, colour = "lightblue", y = 100 * calc_npv_discount(0.148), yend = 100 * calc_npv_discount(0.148)) +
annotate("text",
x = 2, y = 0.1 + 100 * calc_npv_discount(0.148),
label = "Goods (Highest)"
) +
annotate("segment", x = 9.6, xend = 9.6, colour = "darkblue", y = 0, yend = 100 * calc_npv_discount(0.096)) +
annotate("segment", x = 0, xend = 100 * 0.096, colour = "darkblue", y = 100 * calc_npv_discount(0.096), yend = 100 * calc_npv_discount(0.096)) +
annotate("text",
x = 2, y = 0.1 + 100 * calc_npv_discount(0.096),
label = "CPIH (Highest)"
) +
annotate("segment", x = 5.3, xend = 5.3, colour = "darkgrey", y = 0, yend = 100 * calc_npv_discount(0.053)) +
annotate("segment", x = 0, xend = 100 * 0.053, colour = "darkgrey", y = 100 * calc_npv_discount(0.053), yend = 100 * calc_npv_discount(0.053)) +
annotate("text",
x = 2, y = 0.1 + 100 * calc_npv_discount(0.053),
label = "Services (Highest)"
)
gg
gg |>
annotate("segment", x = 2.9, xend = 2.9, colour = "lightblue", linetype = "dashed" y = 0, yend = 100 * calc_npv_discount(0.029)) +
gg |>
annotate("segment", x = 2.9, xend = 2.9, colour = "lightblue", linetype = "dashed", y = 0, yend = 100 * calc_npv_discount(0.029)) +
annotate("segment", x = 0, xend = 100 * 0.029, colour = "lightblue", linetype = "dashed", y = 100 * calc_npv_discount(0.029), yend = 100 * calc_npv_discount(0.029)) +
annotate("text",
x = 2, y = 0.1 + 100 * calc_npv_discount(0.029),
label = "Goods (Current)"
) +
annotate("segment", x = 9.6, xend = 9.6, colour = "darkblue", y = 0, yend = 100 * calc_npv_discount(0.096)) +
annotate("segment", x = 0, xend = 100 * 0.096, colour = "darkblue", y = 100 * calc_npv_discount(0.096), yend = 100 * calc_npv_discount(0.096)) +
annotate("text",
x = 2, y = 0.1 + 100 * calc_npv_discount(0.096),
label = "CPIH (Highest)"
) +
annotate("segment", x = 5.3, xend = 5.3, colour = "darkgrey", y = 0, yend = 100 * calc_npv_discount(0.053)) +
annotate("segment", x = 0, xend = 100 * 0.053, colour = "darkgrey", y = 100 * calc_npv_discount(0.053), yend = 100 * calc_npv_discount(0.053)) +
annotate("text",
x = 2, y = 0.1 + 100 * calc_npv_discount(0.053),
label = "Services (Highest)"
)
gg +
annotate("segment", x = 2.9, xend = 2.9, colour = "lightblue", linetype = "dashed", y = 0, yend = 100 * calc_npv_discount(0.029)) +
annotate("segment", x = 0, xend = 100 * 0.029, colour = "lightblue", linetype = "dashed", y = 100 * calc_npv_discount(0.029), yend = 100 * calc_npv_discount(0.029)) +
annotate("text",
x = 2, y = 0.1 + 100 * calc_npv_discount(0.029),
label = "Goods (Current)"
) +
annotate("segment", x = 9.6, xend = 9.6, colour = "darkblue", y = 0, yend = 100 * calc_npv_discount(0.096)) +
annotate("segment", x = 0, xend = 100 * 0.096, colour = "darkblue", y = 100 * calc_npv_discount(0.096), yend = 100 * calc_npv_discount(0.096)) +
annotate("text",
x = 2, y = 0.1 + 100 * calc_npv_discount(0.096),
label = "CPIH (Highest)"
) +
annotate("segment", x = 5.3, xend = 5.3, colour = "darkgrey", y = 0, yend = 100 * calc_npv_discount(0.053)) +
annotate("segment", x = 0, xend = 100 * 0.053, colour = "darkgrey", y = 100 * calc_npv_discount(0.053), yend = 100 * calc_npv_discount(0.053)) +
annotate("text",
x = 2, y = 0.1 + 100 * calc_npv_discount(0.053),
label = "Services (Highest)"
)
gg +
annotate("segment", x = 2.9, xend = 2.9, colour = "lightblue", linetype = "dashed", y = 0, yend = 100 * calc_npv_discount(0.029)) +
annotate("segment", x = 0, xend = 100 * 0.029, colour = "lightblue", linetype = "dashed", y = 100 * calc_npv_discount(0.029), yend = 100 * calc_npv_discount(0.029)) +
annotate("text",
x = 2, y = 0.1 + 100 * calc_npv_discount(0.029),
label = "Goods (Current)"
) +
annotate("segment", x = 9.6, xend = 4.7, colour = "darkblue", linetype = "dashed", y = 0, yend = 100 * calc_npv_discount(0.047)) +
annotate("segment", x = 0, xend = 100 * 0.047, colour = "darkblue", linetype = "dashed", y = 100 * calc_npv_discount(0.047), yend = 100 * calc_npv_discount(0.047)) +
annotate("text",
x = 2, y = 0.1 + 100 * calc_npv_discount(0.096),
label = "CPIH (Current)"
) +
annotate("segment", x = 5.3, xend = 5.3, colour = "darkgrey", y = 0, yend = 100 * calc_npv_discount(0.053)) +
annotate("segment", x = 0, xend = 100 * 0.053, colour = "darkgrey", y = 100 * calc_npv_discount(0.053), yend = 100 * calc_npv_discount(0.053)) +
annotate("text",
x = 2, y = 0.1 + 100 * calc_npv_discount(0.053),
label = "Services (Highest)"
)
gg +
annotate("segment", x = 2.9, xend = 2.9, colour = "lightblue", linetype = "dashed", y = 0, yend = 100 * calc_npv_discount(0.029)) +
annotate("segment", x = 0, xend = 100 * 0.029, colour = "lightblue", linetype = "dashed", y = 100 * calc_npv_discount(0.029), yend = 100 * calc_npv_discount(0.029)) +
annotate("text",
x = 2, y = 0.1 + 100 * calc_npv_discount(0.029),
label = "Goods (Current)"
) +
annotate("segment", x = 4.7, xend = 4.7, colour = "darkblue", linetype = "dashed", y = 0, yend = 100 * calc_npv_discount(0.047)) +
annotate("segment", x = 0, xend = 100 * 0.047, colour = "darkblue", linetype = "dashed", y = 100 * calc_npv_discount(0.047), yend = 100 * calc_npv_discount(0.047)) +
annotate("text",
x = 2, y = 0.1 + 100 * calc_npv_discount(0.096),
label = "CPIH (Current)"
) +
annotate("segment", x = 5.3, xend = 5.3, colour = "darkgrey", y = 0, yend = 100 * calc_npv_discount(0.053)) +
annotate("segment", x = 0, xend = 100 * 0.053, colour = "darkgrey", y = 100 * calc_npv_discount(0.053), yend = 100 * calc_npv_discount(0.053)) +
annotate("text",
x = 2, y = 0.1 + 100 * calc_npv_discount(0.053),
label = "Services (Highest)"
)
gg +
annotate("segment", x = 2.9, xend = 2.9, colour = "lightblue", linetype = "dashed", y = 0, yend = 100 * calc_npv_discount(0.029)) +
annotate("segment", x = 0, xend = 100 * 0.029, colour = "lightblue", linetype = "dashed", y = 100 * calc_npv_discount(0.029), yend = 100 * calc_npv_discount(0.029)) +
annotate("text",
x = 2, y = 0.1 + 100 * calc_npv_discount(0.029),
label = "Goods (Current)"
) +
annotate("segment", x = 4.7, xend = 4.7, colour = "darkblue", linetype = "dashed", y = 0, yend = 100 * calc_npv_discount(0.047)) +
annotate("segment", x = 0, xend = 100 * 0.047, colour = "darkblue", linetype = "dashed", y = 100 * calc_npv_discount(0.047), yend = 100 * calc_npv_discount(0.047)) +
annotate("text",
x = 2, y = 0.1 + 100 * calc_npv_discount(0.046),
label = "CPIH (Current)"
) +
annotate("segment", x = 5.3, xend = 5.3, colour = "darkgrey", y = 0, yend = 100 * calc_npv_discount(0.053)) +
annotate("segment", x = 0, xend = 100 * 0.053, colour = "darkgrey", y = 100 * calc_npv_discount(0.053), yend = 100 * calc_npv_discount(0.053)) +
annotate("text",
x = 2, y = 0.1 + 100 * calc_npv_discount(0.053),
label = "Services (Highest)"
)
gg +
annotate("segment", x = 2.9, xend = 2.9, colour = "lightblue", linetype = "dashed", y = 0, yend = 100 * calc_npv_discount(0.029)) +
annotate("segment", x = 0, xend = 100 * 0.029, colour = "lightblue", linetype = "dashed", y = 100 * calc_npv_discount(0.029), yend = 100 * calc_npv_discount(0.029)) +
annotate("text",
x = 2, y = 0.1 + 100 * calc_npv_discount(0.029),
label = "Goods (Current)"
) +
annotate("segment", x = 4.7, xend = 4.7, colour = "darkblue", linetype = "dashed", y = 0, yend = 100 * calc_npv_discount(0.047)) +
annotate("segment", x = 0, xend = 100 * 0.047, colour = "darkblue", linetype = "dashed", y = 100 * calc_npv_discount(0.047), yend = 100 * calc_npv_discount(0.047)) +
annotate("text",
x = 2, y = 0.1 + 100 * calc_npv_discount(0.047),
label = "CPIH (Current)"
) +
annotate("segment", x = 5.3, xend = 5.3, colour = "darkgrey", y = 0, yend = 100 * calc_npv_discount(0.053)) +
annotate("segment", x = 0, xend = 100 * 0.053, colour = "darkgrey", y = 100 * calc_npv_discount(0.053), yend = 100 * calc_npv_discount(0.053)) +
annotate("text",
x = 2, y = 0.1 + 100 * calc_npv_discount(0.053),
label = "Services (Highest)"
)
calc_npv_discount <- function(ry, total = 150) {
annual_to_monthly <- function(x) {(1 + x)^(1/12) -1}
rm <- annual_to_monthly(ry)
index0 <- 1
index1 <- index0 / (1 + rm)
index2 <- index1 / (1 + rm)
index3 <- index2 / (1 + rm)
npv_amt1 <- (total / 3) * index1
npv_amt2 <- (total / 3) * index2
npv_amt3 <- (total / 3) * index3
1 - sum(npv_amt1, npv_amt2, npv_amt3) / total
}
df <-
tibble(
annual_rate = seq(0, 0.15, by = 0.01)
) |>
mutate(
effective_discount = map_dbl(annual_rate, calc_npv_discount)
)
gg <-
df |>
ggplot(aes(100 * annual_rate, 100 * effective_discount)) +
geom_line() +
labs(x = "Annual inflation rate (%)",
y = "Effective discount on paying over 3 months (%)",
title = "Effective short-term discount rate against inflation rate"
) +
scale_y_continuous(breaks = seq(0, 15, by = 0.1)) +
annotate("segment", x = 14.8, xend = 14.8, colour = "lightblue", y = 0, yend = 100 * calc_npv_discount(0.148)) +
annotate("segment", x = 0, xend = 100 * 0.148, colour = "lightblue", y = 100 * calc_npv_discount(0.148), yend = 100 * calc_npv_discount(0.148)) +
annotate("segment", x = 9.6, xend = 9.6, colour = "darkblue", y = 0, yend = 100 * calc_npv_discount(0.096)) +
annotate("segment", x = 0, xend = 100 * 0.096, colour = "darkblue", y = 100 * calc_npv_discount(0.096), yend = 100 * calc_npv_discount(0.096)) +
annotate("text",
x = 2, y = 0.1 + 100 * calc_npv_discount(0.096),
label = "CPIH (Highest)"
) +
annotate("segment", x = 5.3, xend = 5.3, colour = "darkgrey", y = 0, yend = 100 * calc_npv_discount(0.053)) +
annotate("segment", x = 0, xend = 100 * 0.053, colour = "darkgrey", y = 100 * calc_npv_discount(0.053), yend = 100 * calc_npv_discount(0.053))
gg +
annotate("text",
x = 2, y = 0.1 + 100 * calc_npv_discount(0.148),
label = "Goods (Highest)"
) +
annotate("text",
x = 2, y = 0.1 + 100 * calc_npv_discount(0.096),
label = "CPIH (Highest)"
) +
annotate("text",
x = 2, y = 0.1 + 100 * calc_npv_discount(0.053),
label = "Services (Highest)"
)
gg +
annotate("segment", x = 2.9, xend = 2.9, colour = "lightblue", linetype = "dashed", y = 0, yend = 100 * calc_npv_discount(0.029)) +
annotate("segment", x = 0, xend = 100 * 0.029, colour = "lightblue", linetype = "dashed", y = 100 * calc_npv_discount(0.029), yend = 100 * calc_npv_discount(0.029)) +
annotate("text",
x = 2, y = 0.1 + 100 * calc_npv_discount(0.029),
label = "Goods (Current)"
) +
annotate("segment", x = 4.7, xend = 4.7, colour = "darkblue", linetype = "dashed", y = 0, yend = 100 * calc_npv_discount(0.047)) +
annotate("segment", x = 0, xend = 100 * 0.047, colour = "darkblue", linetype = "dashed", y = 100 * calc_npv_discount(0.047), yend = 100 * calc_npv_discount(0.047)) +
annotate("text",
x = 2, y = 0.1 + 100 * calc_npv_discount(0.047),
label = "CPIH (Current)"
) +
annotate("segment", x = 5.3, xend = 5.3, colour = "darkgrey", y = 0, yend = 100 * calc_npv_discount(0.053)) +
annotate("segment", x = 0, xend = 100 * 0.053, colour = "darkgrey", y = 100 * calc_npv_discount(0.053), yend = 100 * calc_npv_discount(0.053)) +
annotate("text",
x = 2, y = 0.1 + 100 * calc_npv_discount(0.053),
label = "Services (Highest)"
)
calc_npv_discount <- function(ry, total = 150) {
annual_to_monthly <- function(x) {(1 + x)^(1/12) -1}
rm <- annual_to_monthly(ry)
index0 <- 1
index1 <- index0 / (1 + rm)
index2 <- index1 / (1 + rm)
index3 <- index2 / (1 + rm)
npv_amt1 <- (total / 3) * index1
npv_amt2 <- (total / 3) * index2
npv_amt3 <- (total / 3) * index3
1 - sum(npv_amt1, npv_amt2, npv_amt3) / total
}
df <-
tibble(
annual_rate = seq(0, 0.15, by = 0.01)
) |>
mutate(
effective_discount = map_dbl(annual_rate, calc_npv_discount)
)
gg <-
df |>
ggplot(aes(100 * annual_rate, 100 * effective_discount)) +
geom_line() +
labs(x = "Annual inflation rate (%)",
y = "Effective discount on paying over 3 months (%)",
title = "Effective short-term discount rate against inflation rate"
) +
scale_y_continuous(breaks = seq(0, 15, by = 0.1)) +
annotate("segment", x = 14.8, xend = 14.8, colour = "lightblue", y = 0, yend = 100 * calc_npv_discount(0.148)) +
annotate("segment", x = 0, xend = 100 * 0.148, colour = "lightblue", y = 100 * calc_npv_discount(0.148), yend = 100 * calc_npv_discount(0.148)) +
annotate("segment", x = 9.6, xend = 9.6, colour = "darkblue", y = 0, yend = 100 * calc_npv_discount(0.096)) +
annotate("segment", x = 0, xend = 100 * 0.096, colour = "darkblue", y = 100 * calc_npv_discount(0.096), yend = 100 * calc_npv_discount(0.096)) +
annotate("segment", x = 5.3, xend = 5.3, colour = "darkgrey", y = 0, yend = 100 * calc_npv_discount(0.053)) +
annotate("segment", x = 0, xend = 100 * 0.053, colour = "darkgrey", y = 100 * calc_npv_discount(0.053), yend = 100 * calc_npv_discount(0.053))
gg +
annotate("text",
x = 2, y = 0.1 + 100 * calc_npv_discount(0.148),
label = "Goods (Highest)"
) +
annotate("text",
x = 2, y = 0.1 + 100 * calc_npv_discount(0.096),
label = "CPIH (Highest)"
) +
annotate("text",
x = 2, y = 0.1 + 100 * calc_npv_discount(0.053),
label = "Services (Highest)"
)
gg +
annotate("segment", x = 2.9, xend = 2.9, colour = "lightblue", linetype = "dashed", y = 0, yend = 100 * calc_npv_discount(0.029)) +
annotate("segment", x = 0, xend = 100 * 0.029, colour = "lightblue", linetype = "dashed", y = 100 * calc_npv_discount(0.029), yend = 100 * calc_npv_discount(0.029)) +
annotate("text",
x = 2, y = 0.1 + 100 * calc_npv_discount(0.029),
label = "Goods (Current)"
) +
annotate("segment", x = 4.7, xend = 4.7, colour = "darkblue", linetype = "dashed", y = 0, yend = 100 * calc_npv_discount(0.047)) +
annotate("segment", x = 0, xend = 100 * 0.047, colour = "darkblue", linetype = "dashed", y = 100 * calc_npv_discount(0.047), yend = 100 * calc_npv_discount(0.047)) +
annotate("text",
x = 2, y = 0.1 + 100 * calc_npv_discount(0.047),
label = "CPIH (Current)"
) +
annotate("segment", x = 5.3, xend = 5.3, colour = "darkgrey", y = 0, yend = 100 * calc_npv_discount(0.053)) +
annotate("segment", x = 0, xend = 100 * 0.053, colour = "darkgrey", y = 100 * calc_npv_discount(0.053), yend = 100 * calc_npv_discount(0.053)) +
annotate("text",
x = 2, y = 0.1 + 100 * calc_npv_discount(0.053),
label = "Services (Highest)"
)
gg +
annotate("segment", x = 2.9, xend = 2.9, colour = "lightblue", linetype = "dashed", y = 0, yend = 100 * calc_npv_discount(0.029)) +
annotate("segment", x = 0, xend = 100 * 0.029, colour = "lightblue", linetype = "dashed", y = 100 * calc_npv_discount(0.029), yend = 100 * calc_npv_discount(0.029)) +
annotate("text",
x = 2, y = 0.1 + 100 * calc_npv_discount(0.029),
label = "Goods (Current)"
) +
annotate("segment", x = 4.7, xend = 4.7, colour = "darkblue", linetype = "dashed", y = 0, yend = 100 * calc_npv_discount(0.047)) +
annotate("segment", x = 0, xend = 100 * 0.047, colour = "darkblue", linetype = "dashed", y = 100 * calc_npv_discount(0.047), yend = 100 * calc_npv_discount(0.047)) +
annotate("text",
x = 2, y = 0.1 + 100 * calc_npv_discount(0.047),
label = "CPIH (Current)"
) +
annotate("segment", x = 2.9, xend = 2.9, colour = "darkgrey", linetype = "dashed", y = 0, yend = 100 * calc_npv_discount(0.029)) +
annotate("segment", x = 0, xend = 100 * 0.029, colour = "darkgrey", linetype="dashed", y = 100 * calc_npv_discount(0.029), yend = 100 * calc_npv_discount(0.029)) +
annotate("text",
x = 2, y = 0.1 + 100 * calc_npv_discount(0.029),
label = "Services (Current)"
)
gg +
annotate("segment", x = 2.9, xend = 2.9, colour = "lightblue", linetype = "dashed", y = 0, yend = 100 * calc_npv_discount(0.029)) +
annotate("segment", x = 0, xend = 100 * 0.029, colour = "lightblue", linetype = "dashed", y = 100 * calc_npv_discount(0.029), yend = 100 * calc_npv_discount(0.029)) +
annotate("text",
x = 2, y = 0.1 + 100 * calc_npv_discount(0.029),
label = "Goods (Current)"
) +
annotate("segment", x = 4.7, xend = 4.7, colour = "darkblue", linetype = "dashed", y = 0, yend = 100 * calc_npv_discount(0.047)) +
annotate("segment", x = 0, xend = 100 * 0.047, colour = "darkblue", linetype = "dashed", y = 100 * calc_npv_discount(0.047), yend = 100 * calc_npv_discount(0.047)) +
annotate("text",
x = 2, y = 0.1 + 100 * calc_npv_discount(0.047),
label = "CPIH (Current)"
) +
annotate("segment", x = 6.2, xend = 6.2, colour = "darkgrey", linetype = "dashed", y = 0, yend = 100 * calc_npv_discount(0.062)) +
annotate("segment", x = 0, xend = 100 * 0.062, colour = "darkgrey", linetype="dashed", y = 100 * calc_npv_discount(0.062), yend = 100 * calc_npv_discount(0.062)) +
annotate("text",
x = 2, y = 0.1 + 100 * calc_npv_discount(0.062),
label = "Services (Current)"
)
