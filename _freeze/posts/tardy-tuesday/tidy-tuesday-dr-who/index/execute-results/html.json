{
  "hash": "d76cb415829ad9d2e1a6a3c40f5888d1",
  "result": {
    "markdown": "---\ntitle: \"Tidy Tuesday on Dr Who\"\nauthor: \n  - \"Jon Minton\"\n  - \"Nick Christofides\"\ndate: \"2023-11-29\"\ncategories: [R, tidy tuesday, Dr Who]\n---\n\n\n## Tidy Tuesday challenge\n\nFirst we load the packages \n\nThe tidyverse equivalent of pacman is now pak.\n\nThe latest dataset is [here](https://github.com/rfordatascience/tidytuesday/tree/master/data/2023/2023-11-28), and the specific files to work. \n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(tidyverse)\n```\n\n::: {.cell-output .cell-output-stderr}\n```\n── Attaching core tidyverse packages ──────────────────────── tidyverse 2.0.0 ──\n✔ dplyr     1.1.4     ✔ readr     2.1.5\n✔ forcats   1.0.0     ✔ stringr   1.5.1\n✔ ggplot2   3.4.4     ✔ tibble    3.2.1\n✔ lubridate 1.9.3     ✔ tidyr     1.3.0\n✔ purrr     1.0.2     \n── Conflicts ────────────────────────────────────────── tidyverse_conflicts() ──\n✖ dplyr::filter() masks stats::filter()\n✖ dplyr::lag()    masks stats::lag()\nℹ Use the conflicted package (<http://conflicted.r-lib.org/>) to force all conflicts to become errors\n```\n:::\n\n```{.r .cell-code}\ndta_list <- tidytuesdayR::tt_load(x = \"2023-11-28\")\n```\n\n::: {.cell-output .cell-output-stderr}\n```\n--- Compiling #TidyTuesday Information for 2023-11-28 ----\n--- There are 3 files available ---\n--- Starting Download ---\n```\n:::\n\n::: {.cell-output .cell-output-stdout}\n```\n\n\tDownloading file 1 of 3: `drwho_episodes.csv`\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\nOnly 10 Github queries remaining until 2024-02-15 11:37:03 AM GMT.\n```\n:::\n\n::: {.cell-output .cell-output-stdout}\n```\n\tDownloading file 2 of 3: `drwho_directors.csv`\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\nOnly 9 Github queries remaining until 2024-02-15 11:37:03 AM GMT.\n```\n:::\n\n::: {.cell-output .cell-output-stdout}\n```\n\tDownloading file 3 of 3: `drwho_writers.csv`\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\nOnly 8 Github queries remaining until 2024-02-15 11:37:03 AM GMT.\n```\n:::\n\n\n::: {.cell-output .cell-output-stderr}\n```\n--- Download complete ---\n```\n:::\n\n```{.r .cell-code}\ndta_eps <- dta_list[[\"drwho_episodes\"]]\ndta_wrt <- dta_list[[\"drwho_writers\"]]\n```\n:::\n\n\nLet's see how the viewship changed over time \n\n\n::: {.cell}\n\n```{.r .cell-code}\ndta_eps_season <- \n  dta_eps |> \n  group_by(season_number) |> \n  mutate(\n    mean_viewers = mean(uk_viewers),\n    mean_date = mean(first_aired)\n    ) |> \n  ungroup()\n\ndta_eps_season |> \n  ggplot(aes(x = first_aired, y = uk_viewers)) + \n  geom_point(colour = \"grey\") +\n  geom_point(aes(x = mean_date, y = mean_viewers), size = 2.5) + \n  scale_x_date(breaks = \"2 years\", labels = \\(x) format(x, \"%Y\")) +\n  labs(\n    x = \"First aired\",\n    y = \"UK Viewers (millions)\",\n    title = \"Viewers over time for Dr Who\",\n    subtitle = \"People don't watch TV like they used to...\"\n  ) +\n  annotate(\"text\", x = lubridate::make_date(2015), y = 10, label = \"What happened here?!\") +\n  annotate(\"text\", x = lubridate::make_date(2014), y= 8, label = \"Smartphone strangling the TV from now\", hjust = 0) + \n  stat_smooth(colour = \"blue\", se = FALSE) \n```\n\n::: {.cell-output .cell-output-stderr}\n```\n`geom_smooth()` using method = 'loess' and formula = 'y ~ x'\n```\n:::\n\n::: {.cell-output-display}\n![](index_files/figure-html/unnamed-chunk-2-1.png){width=672}\n:::\n:::\n\n\nLet's now look at writers by season\n\n\n::: {.cell}\n\n```{.r .cell-code}\ndta_eps_wrt <- \n  dta_eps |> \n    left_join(dta_wrt, by = \"story_number\") \n```\n:::\n\n\nHow many episodes by writer?\n\n\n::: {.cell}\n\n```{.r .cell-code}\ndta_eps_wrt |> \n  group_by(writer) |>  \n  summarise(\n    n_written = n()\n  ) |> \n  ungroup() |> \n  arrange(desc(n_written))\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n# A tibble: 40 × 2\n   writer           n_written\n   <chr>                <int>\n 1 Steven Moffat           45\n 2 Russell T Davies        31\n 3 Chris Chibnall          29\n 4 Mark Gatiss              9\n 5 Toby Whithouse           7\n 6 Gareth Roberts           5\n 7 Helen Raynor             4\n 8 Jamie Mathieson          4\n 9 Peter Harness            4\n10 Matthew Graham           3\n# ℹ 30 more rows\n```\n:::\n:::\n\nSo Moffat wrote most episodes, then Davies, then Chibnall\n\nAnd what about popularity by writer?\n\n\n::: {.cell}\n\n```{.r .cell-code}\ndta_eps_wrt |> \n  group_by(writer) |>  \n  mutate(\n    n_written = n()\n  ) |> \n  ungroup() |> \n  filter(n_written >= 5) |> \n  ggplot(aes(x = fct_reorder(writer, rating), y= rating)) + \n  geom_boxplot() + \n  coord_flip() + \n  labs(\n    x = \"Distribution of ratings\",\n    y = \"Writer\", \n    title = \"Rating distribution by writer\",\n    subtitle = \"Writers who wrote at least five episodes\"\n  )\n```\n\n::: {.cell-output-display}\n![](index_files/figure-html/unnamed-chunk-5-1.png){width=672}\n:::\n:::\n\n\nWhen were the different writers active?\n\n\n::: {.cell}\n\n```{.r .cell-code}\nmajor_writers_active <- \n  dta_eps_wrt |> \n    group_by(writer) |>  \n    mutate(\n      n_written = n()\n    ) |> \n    ungroup() |> \n    filter(n_written >= 5) |> \n    group_by(writer) |> \n    summarise(\n      started_writing = min(first_aired),\n      finished_writing = max(first_aired),\n      n_written = n_written[1]\n    ) |> \n    ungroup() |> \n    mutate(\n      yr_start = year(started_writing),\n      yr_end = year(finished_writing)\n    )\n\nmajor_writers_active |> \n  arrange(started_writing)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n# A tibble: 6 × 6\n  writer           started_writing finished_writing n_written yr_start yr_end\n  <chr>            <date>          <date>               <int>    <dbl>  <dbl>\n1 Russell T Davies 2005-03-26      2010-01-01              31     2005   2010\n2 Mark Gatiss      2005-04-09      2017-06-10               9     2005   2017\n3 Steven Moffat    2005-05-21      2017-12-25              45     2005   2017\n4 Toby Whithouse   2006-04-29      2017-06-03               7     2006   2017\n5 Gareth Roberts   2007-04-07      2011-09-24               5     2007   2011\n6 Chris Chibnall   2007-05-19      2022-10-23              29     2007   2022\n```\n:::\n:::\n\n\n\nHere we see the tenure of different major writers. Russell T Davies and Steven Moffatt are the major players.\n\n\n\n## Coda\n\nNeither of us know much about Dr Who! \n\nBut hopefully we now know a bit more!\n\n\n\n\n",
    "supporting": [
      "index_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}