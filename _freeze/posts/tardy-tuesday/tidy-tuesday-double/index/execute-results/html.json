{
  "hash": "350482660de7db986d6faef68cf01349",
  "result": {
    "markdown": "---\ntitle: \"Double Tardy Tuesday\"\nsubtitle: \"Mea Culpa\"\ndate: \"2024-04-02\"\nauthor: \"Jon Minton\"\ncategories: [Tidy Tuesday, Tardy, Data Science]\n---\n\n\n## Introduction \n\nI've been exceptionally tardy updating the Tardy Tuesday blog the last couple of weeks. So there are a couple of weeks worth of code to update with at once. Unlike previous times I'm going to list only myself as the author of this blog, as none of the contributors deserve any blame for my tardiness! \n\nAdditionally, the scripts will be presented more 'as-is' than on previous occasions, without as much additional discussion or amendments. \n\n## Common package dependencies\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(tidyverse)\n```\n\n::: {.cell-output .cell-output-stderr}\n```\n── Attaching core tidyverse packages ──────────────────────── tidyverse 2.0.0 ──\n✔ dplyr     1.1.4     ✔ readr     2.1.5\n✔ forcats   1.0.0     ✔ stringr   1.5.1\n✔ ggplot2   3.5.0     ✔ tibble    3.2.1\n✔ lubridate 1.9.3     ✔ tidyr     1.3.1\n✔ purrr     1.0.2     \n── Conflicts ────────────────────────────────────────── tidyverse_conflicts() ──\n✖ dplyr::filter() masks stats::filter()\n✖ dplyr::lag()    masks stats::lag()\nℹ Use the conflicted package (<http://conflicted.r-lib.org/>) to force all conflicts to become errors\n```\n:::\n:::\n\n\n## Mutant Moneyball \n\n[This TidyTuesday](https://github.com/rfordatascience/tidytuesday/tree/master/data/2024/2024-03-19) dataset involved understanding the relationship between the value of old Mavel comics and the appearance of particular characters in those comics. I'm not sure it was a good or bad thing that we didn't know the names of most of the characters...\n\nThe session was led by Brendan, who wrote (with our support) the script below:\n\n\n::: {.cell}\n\n```{.r .cell-code}\ntidytuesdayR::tt_load('2024-03-19') \n```\n\n::: {.cell-output .cell-output-stderr}\n```\n--- Compiling #TidyTuesday Information for 2024-03-19 ----\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\n--- There is 1 file available ---\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\n--- Starting Download ---\n```\n:::\n\n::: {.cell-output .cell-output-stdout}\n```\n\n\tDownloading file 1 of 1: `mutant_moneyball.csv`\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\n--- Download complete ---\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\nAvailable datasets:\n\tmutant_moneyball \n\t\n```\n:::\n\n```{.r .cell-code}\nmutant_moneyball <- tidytuesdayR::tt_load('2024-03-19') |>\n  pluck(1)\n```\n\n::: {.cell-output .cell-output-stderr}\n```\n--- Compiling #TidyTuesday Information for 2024-03-19 ----\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\n--- There is 1 file available ---\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\n--- Starting Download ---\n```\n:::\n\n::: {.cell-output .cell-output-stdout}\n```\n\n\tDownloading file 1 of 1: `mutant_moneyball.csv`\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\n--- Download complete ---\n```\n:::\n\n```{.r .cell-code}\nstr(mutant_moneyball)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\nspc_tbl_ [26 × 45] (S3: spec_tbl_df/tbl_df/tbl/data.frame)\n $ Member                : chr [1:26] \"warrenWorthington\" \"hankMcCoy\" \"scottSummers\" \"bobbyDrake\" ...\n $ TotalIssues           : num [1:26] 139 119 197 123 164 68 48 190 120 167 ...\n $ TotalIssues60s        : num [1:26] 61 62 63 62 63 8 9 0 0 0 ...\n $ TotalIssues70s        : num [1:26] 35 38 69 35 58 13 13 36 36 36 ...\n $ TotalIssues80s        : num [1:26] 20 9 56 6 14 43 19 121 84 115 ...\n $ TotalIssues90s        : num [1:26] 23 10 9 20 29 4 7 33 0 16 ...\n $ totalIssueCheck       : num [1:26] 139 119 197 123 164 68 48 190 120 167 ...\n $ TotalValue_heritage   : num [1:26] 1108558 957993 1152230 1086749 1132091 ...\n $ TotalValue60s_heritage: num [1:26] 929056 929776 933616 929776 933616 ...\n $ TotalValue70s_heritage: num [1:26] 154585 20705 188635 154585 179899 ...\n $ TotalValue80s_heritage: num [1:26] 23957 6631 29240 1514 16868 ...\n $ TotalValue90s_heritage: num [1:26] 960 881 739 874 1708 ...\n $ TotalValue_ebay       : num [1:26] 27377 24972 29964 26902 29158 ...\n $ TotalValue60s_ebay    : num [1:26] 23335 23377 23420 23377 23420 ...\n $ TotalValue70s_ebay    : num [1:26] 3362 1224 5431 3362 4903 ...\n $ TotalValue80s_ebay    : num [1:26] 583 289 1031 70 665 ...\n $ TotalValue90s_ebay    : num [1:26] 97 82 82 93 170 21 41 334 0 100 ...\n $ 60s_Appearance_Percent: chr [1:26] \"96.83%\" \"98.41%\" \"100.00%\" \"98.41%\" ...\n $ 70s_Appearance_Percent: chr [1:26] \"50.72%\" \"55.07%\" \"100.00%\" \"50.72%\" ...\n $ 80s_Appearance_Percent: chr [1:26] \"14.60%\" \"6.57%\" \"40.88%\" \"4.38%\" ...\n $ 90s_Appearance_Percent: chr [1:26] \"51.11%\" \"22.22%\" \"20.00%\" \"44.44%\" ...\n $ PPI60s_heritage       : chr [1:26] \"$15,230.43 \" \"$14,996.39 \" \"$14,819.30 \" \"$14,996.39 \" ...\n $ PPI70s_heritage       : chr [1:26] \"$4,416.71 \" \"$544.87 \" \"$2,733.84 \" \"$4,416.71 \" ...\n $ PPI80s_heritage       : chr [1:26] \"$1,197.85 \" \"$736.78 \" \"$522.14 \" \"$252.33 \" ...\n $ PPI90s_heritage       : chr [1:26] \"$41.74 \" \"$88.10 \" \"$82.11 \" \"$43.70 \" ...\n $ PPI60s_ebay           : chr [1:26] \"$382.54 \" \"$377.05 \" \"$371.75 \" \"$377.05 \" ...\n $ PPI70s_ebay           : chr [1:26] \"$96.06 \" \"$32.21 \" \"$78.71 \" \"$96.06 \" ...\n $ PPI80s_ebay           : chr [1:26] \"$29.15 \" \"$32.11 \" \"$18.41 \" \"$11.67 \" ...\n $ PPI90s_ebay           : chr [1:26] \"$4.22 \" \"$8.20 \" \"$9.11 \" \"$4.65 \" ...\n $ TotalValue60s_wiz     : chr [1:26] \"$7,913.00 \" \"$7,953.00 \" \"$7,993.00 \" \"$7,953.00 \" ...\n $ TotalValue70s_wiz     : chr [1:26] \"$1,105.00 \" \"$851.00 \" \"$1,979.00 \" \"$1,105.00 \" ...\n $ TotalValue80s_wiz     : chr [1:26] \"$226.00 \" \"$89.00 \" \"$438.00 \" \"$48.00 \" ...\n $ TotalValue90s_wiz     : chr [1:26] \"$65.75 \" \"$38.50 \" \"$39.25 \" \"$62.00 \" ...\n $ TotalValue60s_oStreet : chr [1:26] \"$68,160.00 \" \"$68,390.00 \" \"$68,590.00 \" \"$68,390.00 \" ...\n $ TotalValue70s_oStreet : chr [1:26] \"$7,360.00 \" \"$5,260.00 \" \"$11,675.00 \" \"$7,360.00 \" ...\n $ TotalValue80s_oStreet : chr [1:26] \"$975.00 \" \"$431.00 \" \"$1,427.00 \" \"$137.00 \" ...\n $ TotalValue90s_oStreet : chr [1:26] \"$123.00 \" \"$81.00 \" \"$74.00 \" \"$108.00 \" ...\n $ PPI60s_wiz            : chr [1:26] \"$129.72 \" \"$128.27 \" \"$126.87 \" \"$128.27 \" ...\n $ PPI70s_wiz            : chr [1:26] \"$31.57 \" \"$22.39 \" \"$28.68 \" \"$31.57 \" ...\n $ PPI80s_wiz            : chr [1:26] \"$11.30 \" \"$9.89 \" \"$7.82 \" \"$8.00 \" ...\n $ PPI90s_wiz            : chr [1:26] \"$2.86 \" \"$3.85 \" \"$4.36 \" \"$3.10 \" ...\n $ PPI60s_oStreet        : chr [1:26] \"$1,117.38 \" \"$1,103.06 \" \"$1,088.73 \" \"$1,103.06 \" ...\n $ PPI70s_oStreet        : chr [1:26] \"$210.29 \" \"$138.42 \" \"$169.20 \" \"$210.29 \" ...\n $ PPI80s_oStreet        : chr [1:26] \"$48.75 \" \"$47.89 \" \"$25.48 \" \"$22.83 \" ...\n $ PPI90s_oStreet        : chr [1:26] \"$5.35 \" \"$8.10 \" \"$8.22 \" \"$5.40 \" ...\n - attr(*, \"spec\")=\n  .. cols(\n  ..   Member = col_character(),\n  ..   TotalIssues = col_double(),\n  ..   TotalIssues60s = col_double(),\n  ..   TotalIssues70s = col_double(),\n  ..   TotalIssues80s = col_double(),\n  ..   TotalIssues90s = col_double(),\n  ..   totalIssueCheck = col_double(),\n  ..   TotalValue_heritage = col_double(),\n  ..   TotalValue60s_heritage = col_double(),\n  ..   TotalValue70s_heritage = col_double(),\n  ..   TotalValue80s_heritage = col_double(),\n  ..   TotalValue90s_heritage = col_double(),\n  ..   TotalValue_ebay = col_double(),\n  ..   TotalValue60s_ebay = col_double(),\n  ..   TotalValue70s_ebay = col_double(),\n  ..   TotalValue80s_ebay = col_double(),\n  ..   TotalValue90s_ebay = col_double(),\n  ..   `60s_Appearance_Percent` = col_character(),\n  ..   `70s_Appearance_Percent` = col_character(),\n  ..   `80s_Appearance_Percent` = col_character(),\n  ..   `90s_Appearance_Percent` = col_character(),\n  ..   PPI60s_heritage = col_character(),\n  ..   PPI70s_heritage = col_character(),\n  ..   PPI80s_heritage = col_character(),\n  ..   PPI90s_heritage = col_character(),\n  ..   PPI60s_ebay = col_character(),\n  ..   PPI70s_ebay = col_character(),\n  ..   PPI80s_ebay = col_character(),\n  ..   PPI90s_ebay = col_character(),\n  ..   TotalValue60s_wiz = col_character(),\n  ..   TotalValue70s_wiz = col_character(),\n  ..   TotalValue80s_wiz = col_character(),\n  ..   TotalValue90s_wiz = col_character(),\n  ..   TotalValue60s_oStreet = col_character(),\n  ..   TotalValue70s_oStreet = col_character(),\n  ..   TotalValue80s_oStreet = col_character(),\n  ..   TotalValue90s_oStreet = col_character(),\n  ..   PPI60s_wiz = col_character(),\n  ..   PPI70s_wiz = col_character(),\n  ..   PPI80s_wiz = col_character(),\n  ..   PPI90s_wiz = col_character(),\n  ..   PPI60s_oStreet = col_character(),\n  ..   PPI70s_oStreet = col_character(),\n  ..   PPI80s_oStreet = col_character(),\n  ..   PPI90s_oStreet = col_character()\n  .. )\n - attr(*, \"problems\")=<externalptr> \n```\n:::\n\n```{.r .cell-code}\n# filter by totalIssueCheck == TotalIssues for missing issues, then remove both\n\nmutant_moneyball |>\n  filter(totalIssueCheck != TotalIssues) |>\n  nrow()\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] 0\n```\n:::\n\n```{.r .cell-code}\n# split TotalIssues and Member into issues data\n\nappearances <- mutant_moneyball |>\n  select(Member, contains(\"ssues\")) |>\n  pivot_longer(!Member) |>\n  mutate(first = str_to_title(str_extract(Member, \"^[[:lower:]]*\"))) |>\n  mutate(last = str_remove(Member, \"^[[:lower:]]*\" )) |>\n  mutate(Member = paste(first, last), .keep=\"unused\") \n\nappearances |>\n  filter(name == \"TotalIssues\") |>\n  arrange(desc(value))\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n# A tibble: 26 × 3\n   Member             name        value\n   <chr>              <chr>       <dbl>\n 1 Scott Summers      TotalIssues   197\n 2 Ororo Munroe       TotalIssues   190\n 3 Peter Rasputin     TotalIssues   169\n 4 Charles Xavier     TotalIssues   169\n 5 Logan Howlett      TotalIssues   167\n 6 Jean Grey          TotalIssues   164\n 7 Warren Worthington TotalIssues   139\n 8 Bobby Drake        TotalIssues   123\n 9 Kurt Wagner        TotalIssues   120\n10 Hank McCoy         TotalIssues   119\n# ℹ 16 more rows\n```\n:::\n\n```{.r .cell-code}\nbest_xm <- appearances |>\n  slice_max(value, n=10) |>\n  pull(Member)\n\nappearances |>\n  mutate(first = str_to_title(str_extract(Member, \"^[[:lower:]]*\"))) |>\n  mutate(last = str_remove(Member, \"^[[:lower:]]*\" )) |>\n  mutate(Member = paste(first, last), .keep=\"unused\") \n```\n\n::: {.cell-output .cell-output-stdout}\n```\n# A tibble: 130 × 3\n   Member                name           value\n   <chr>                 <chr>          <dbl>\n 1 \" Warren Worthington\" TotalIssues      139\n 2 \" Warren Worthington\" TotalIssues60s    61\n 3 \" Warren Worthington\" TotalIssues70s    35\n 4 \" Warren Worthington\" TotalIssues80s    20\n 5 \" Warren Worthington\" TotalIssues90s    23\n 6 \" Hank McCoy\"         TotalIssues      119\n 7 \" Hank McCoy\"         TotalIssues60s    62\n 8 \" Hank McCoy\"         TotalIssues70s    38\n 9 \" Hank McCoy\"         TotalIssues80s     9\n10 \" Hank McCoy\"         TotalIssues90s    10\n# ℹ 120 more rows\n```\n:::\n\n```{.r .cell-code}\ndates <- tribble(\n  ~start, ~end, ~decade,\n  1963, 1969, 60,\n  1970, 1979, 70,\n  1980, 1989, 80,\n  1990, 1992, 90\n)\n\nplot <- appearances |>\n  mutate(decade = as.numeric(str_extract(name, \"\\\\d{2}\"))) |>\n  filter(!is.na(decade)) |>\n  left_join(dates) |>\n  mutate(year_range = 1 + end - start) |>\n  mutate(rate = value / year_range) |>\n  relocate(last_col()) |>\n  filter(Member %in% best_xm) |>\n  ggplot(aes(x = start, y = rate, colour = Member)) +\n  geom_line() +\n  geom_point() +\n  theme(legend.position = \"bottom\")\n```\n\n::: {.cell-output .cell-output-stderr}\n```\nJoining with `by = join_by(decade)`\n```\n:::\n\n```{.r .cell-code}\nplotly::ggplotly(plot)\n```\n\n::: {.cell-output-display}\n```{=html}\n<div class=\"plotly html-widget html-fill-item\" id=\"htmlwidget-5ce7668ea1f6e29d9dd7\" style=\"width:100%;height:464px;\"></div>\n<script type=\"application/json\" data-for=\"htmlwidget-5ce7668ea1f6e29d9dd7\">{\"x\":{\"data\":[{\"x\":[1963,1970,1980,1990],\"y\":[8.8571428571428577,3.5,0.59999999999999998,6.666666666666667],\"text\":[\"start: 1963<br />rate:  8.857143<br />Member: Bobby Drake\",\"start: 1970<br />rate:  3.500000<br />Member: Bobby Drake\",\"start: 1980<br />rate:  0.600000<br />Member: Bobby Drake\",\"start: 1990<br />rate:  6.666667<br />Member: Bobby Drake\"],\"type\":\"scatter\",\"mode\":\"lines+markers\",\"line\":{\"width\":1.8897637795275593,\"color\":\"rgba(248,118,109,1)\",\"dash\":\"solid\"},\"hoveron\":\"points\",\"name\":\"Bobby Drake\",\"legendgroup\":\"Bobby Drake\",\"showlegend\":true,\"xaxis\":\"x\",\"yaxis\":\"y\",\"hoverinfo\":\"text\",\"marker\":{\"autocolorscale\":false,\"color\":\"rgba(248,118,109,1)\",\"opacity\":1,\"size\":5.6692913385826778,\"symbol\":\"circle\",\"line\":{\"width\":1.8897637795275593,\"color\":\"rgba(248,118,109,1)\"}},\"frame\":null},{\"x\":[1963,1970,1980,1990],\"y\":[5.5714285714285712,4.5999999999999996,6.0999999999999996,7.666666666666667],\"text\":[\"start: 1963<br />rate:  5.571429<br />Member: Charles Xavier\",\"start: 1970<br />rate:  4.600000<br />Member: Charles Xavier\",\"start: 1980<br />rate:  6.100000<br />Member: Charles Xavier\",\"start: 1990<br />rate:  7.666667<br />Member: Charles Xavier\"],\"type\":\"scatter\",\"mode\":\"lines+markers\",\"line\":{\"width\":1.8897637795275593,\"color\":\"rgba(211,146,0,1)\",\"dash\":\"solid\"},\"hoveron\":\"points\",\"name\":\"Charles Xavier\",\"legendgroup\":\"Charles Xavier\",\"showlegend\":true,\"xaxis\":\"x\",\"yaxis\":\"y\",\"hoverinfo\":\"text\",\"marker\":{\"autocolorscale\":false,\"color\":\"rgba(211,146,0,1)\",\"opacity\":1,\"size\":5.6692913385826778,\"symbol\":\"circle\",\"line\":{\"width\":1.8897637795275593,\"color\":\"rgba(211,146,0,1)\"}},\"frame\":null},{\"x\":[1963,1970,1980,1990],\"y\":[9,5.7999999999999998,1.3999999999999999,9.6666666666666661],\"text\":[\"start: 1963<br />rate:  9.000000<br />Member: Jean Grey\",\"start: 1970<br />rate:  5.800000<br />Member: Jean Grey\",\"start: 1980<br />rate:  1.400000<br />Member: Jean Grey\",\"start: 1990<br />rate:  9.666667<br />Member: Jean Grey\"],\"type\":\"scatter\",\"mode\":\"lines+markers\",\"line\":{\"width\":1.8897637795275593,\"color\":\"rgba(147,170,0,1)\",\"dash\":\"solid\"},\"hoveron\":\"points\",\"name\":\"Jean Grey\",\"legendgroup\":\"Jean Grey\",\"showlegend\":true,\"xaxis\":\"x\",\"yaxis\":\"y\",\"hoverinfo\":\"text\",\"marker\":{\"autocolorscale\":false,\"color\":\"rgba(147,170,0,1)\",\"opacity\":1,\"size\":5.6692913385826778,\"symbol\":\"circle\",\"line\":{\"width\":1.8897637795275593,\"color\":\"rgba(147,170,0,1)\"}},\"frame\":null},{\"x\":[1963,1970,1980,1990],\"y\":[0,3.6000000000000001,8.4000000000000004,0],\"text\":[\"start: 1963<br />rate:  0.000000<br />Member: Kurt Wagner\",\"start: 1970<br />rate:  3.600000<br />Member: Kurt Wagner\",\"start: 1980<br />rate:  8.400000<br />Member: Kurt Wagner\",\"start: 1990<br />rate:  0.000000<br />Member: Kurt Wagner\"],\"type\":\"scatter\",\"mode\":\"lines+markers\",\"line\":{\"width\":1.8897637795275593,\"color\":\"rgba(0,186,56,1)\",\"dash\":\"solid\"},\"hoveron\":\"points\",\"name\":\"Kurt Wagner\",\"legendgroup\":\"Kurt Wagner\",\"showlegend\":true,\"xaxis\":\"x\",\"yaxis\":\"y\",\"hoverinfo\":\"text\",\"marker\":{\"autocolorscale\":false,\"color\":\"rgba(0,186,56,1)\",\"opacity\":1,\"size\":5.6692913385826778,\"symbol\":\"circle\",\"line\":{\"width\":1.8897637795275593,\"color\":\"rgba(0,186,56,1)\"}},\"frame\":null},{\"x\":[1963,1970,1980,1990],\"y\":[0,3.6000000000000001,11.5,5.333333333333333],\"text\":[\"start: 1963<br />rate:  0.000000<br />Member: Logan Howlett\",\"start: 1970<br />rate:  3.600000<br />Member: Logan Howlett\",\"start: 1980<br />rate: 11.500000<br />Member: Logan Howlett\",\"start: 1990<br />rate:  5.333333<br />Member: Logan Howlett\"],\"type\":\"scatter\",\"mode\":\"lines+markers\",\"line\":{\"width\":1.8897637795275593,\"color\":\"rgba(0,193,159,1)\",\"dash\":\"solid\"},\"hoveron\":\"points\",\"name\":\"Logan Howlett\",\"legendgroup\":\"Logan Howlett\",\"showlegend\":true,\"xaxis\":\"x\",\"yaxis\":\"y\",\"hoverinfo\":\"text\",\"marker\":{\"autocolorscale\":false,\"color\":\"rgba(0,193,159,1)\",\"opacity\":1,\"size\":5.6692913385826778,\"symbol\":\"circle\",\"line\":{\"width\":1.8897637795275593,\"color\":\"rgba(0,193,159,1)\"}},\"frame\":null},{\"x\":[1963,1970,1980,1990],\"y\":[0,3.6000000000000001,12.1,11],\"text\":[\"start: 1963<br />rate:  0.000000<br />Member: Ororo Munroe\",\"start: 1970<br />rate:  3.600000<br />Member: Ororo Munroe\",\"start: 1980<br />rate: 12.100000<br />Member: Ororo Munroe\",\"start: 1990<br />rate: 11.000000<br />Member: Ororo Munroe\"],\"type\":\"scatter\",\"mode\":\"lines+markers\",\"line\":{\"width\":1.8897637795275593,\"color\":\"rgba(0,185,227,1)\",\"dash\":\"solid\"},\"hoveron\":\"points\",\"name\":\"Ororo Munroe\",\"legendgroup\":\"Ororo Munroe\",\"showlegend\":true,\"xaxis\":\"x\",\"yaxis\":\"y\",\"hoverinfo\":\"text\",\"marker\":{\"autocolorscale\":false,\"color\":\"rgba(0,185,227,1)\",\"opacity\":1,\"size\":5.6692913385826778,\"symbol\":\"circle\",\"line\":{\"width\":1.8897637795275593,\"color\":\"rgba(0,185,227,1)\"}},\"frame\":null},{\"x\":[1963,1970,1980,1990],\"y\":[0,3.6000000000000001,11,7.666666666666667],\"text\":[\"start: 1963<br />rate:  0.000000<br />Member: Peter Rasputin\",\"start: 1970<br />rate:  3.600000<br />Member: Peter Rasputin\",\"start: 1980<br />rate: 11.000000<br />Member: Peter Rasputin\",\"start: 1990<br />rate:  7.666667<br />Member: Peter Rasputin\"],\"type\":\"scatter\",\"mode\":\"lines+markers\",\"line\":{\"width\":1.8897637795275593,\"color\":\"rgba(97,156,255,1)\",\"dash\":\"solid\"},\"hoveron\":\"points\",\"name\":\"Peter Rasputin\",\"legendgroup\":\"Peter Rasputin\",\"showlegend\":true,\"xaxis\":\"x\",\"yaxis\":\"y\",\"hoverinfo\":\"text\",\"marker\":{\"autocolorscale\":false,\"color\":\"rgba(97,156,255,1)\",\"opacity\":1,\"size\":5.6692913385826778,\"symbol\":\"circle\",\"line\":{\"width\":1.8897637795275593,\"color\":\"rgba(97,156,255,1)\"}},\"frame\":null},{\"x\":[1963,1970,1980,1990],\"y\":[9,6.9000000000000004,5.5999999999999996,3],\"text\":[\"start: 1963<br />rate:  9.000000<br />Member: Scott Summers\",\"start: 1970<br />rate:  6.900000<br />Member: Scott Summers\",\"start: 1980<br />rate:  5.600000<br />Member: Scott Summers\",\"start: 1990<br />rate:  3.000000<br />Member: Scott Summers\"],\"type\":\"scatter\",\"mode\":\"lines+markers\",\"line\":{\"width\":1.8897637795275593,\"color\":\"rgba(219,114,251,1)\",\"dash\":\"solid\"},\"hoveron\":\"points\",\"name\":\"Scott Summers\",\"legendgroup\":\"Scott Summers\",\"showlegend\":true,\"xaxis\":\"x\",\"yaxis\":\"y\",\"hoverinfo\":\"text\",\"marker\":{\"autocolorscale\":false,\"color\":\"rgba(219,114,251,1)\",\"opacity\":1,\"size\":5.6692913385826778,\"symbol\":\"circle\",\"line\":{\"width\":1.8897637795275593,\"color\":\"rgba(219,114,251,1)\"}},\"frame\":null},{\"x\":[1963,1970,1980,1990],\"y\":[8.7142857142857135,3.5,2,7.666666666666667],\"text\":[\"start: 1963<br />rate:  8.714286<br />Member: Warren Worthington\",\"start: 1970<br />rate:  3.500000<br />Member: Warren Worthington\",\"start: 1980<br />rate:  2.000000<br />Member: Warren Worthington\",\"start: 1990<br />rate:  7.666667<br />Member: Warren Worthington\"],\"type\":\"scatter\",\"mode\":\"lines+markers\",\"line\":{\"width\":1.8897637795275593,\"color\":\"rgba(255,97,195,1)\",\"dash\":\"solid\"},\"hoveron\":\"points\",\"name\":\"Warren Worthington\",\"legendgroup\":\"Warren Worthington\",\"showlegend\":true,\"xaxis\":\"x\",\"yaxis\":\"y\",\"hoverinfo\":\"text\",\"marker\":{\"autocolorscale\":false,\"color\":\"rgba(255,97,195,1)\",\"opacity\":1,\"size\":5.6692913385826778,\"symbol\":\"circle\",\"line\":{\"width\":1.8897637795275593,\"color\":\"rgba(255,97,195,1)\"}},\"frame\":null}],\"layout\":{\"margin\":{\"t\":26.228310502283108,\"r\":7.3059360730593621,\"b\":40.182648401826498,\"l\":48.949771689497723},\"plot_bgcolor\":\"rgba(235,235,235,1)\",\"paper_bgcolor\":\"rgba(255,255,255,1)\",\"font\":{\"color\":\"rgba(0,0,0,1)\",\"family\":\"\",\"size\":14.611872146118724},\"xaxis\":{\"domain\":[0,1],\"automargin\":true,\"type\":\"linear\",\"autorange\":false,\"range\":[1961.6500000000001,1991.3499999999999],\"tickmode\":\"array\",\"ticktext\":[\"1970\",\"1980\",\"1990\"],\"tickvals\":[1970,1980,1990],\"categoryorder\":\"array\",\"categoryarray\":[\"1970\",\"1980\",\"1990\"],\"nticks\":null,\"ticks\":\"outside\",\"tickcolor\":\"rgba(51,51,51,1)\",\"ticklen\":3.6529680365296811,\"tickwidth\":0.66417600664176002,\"showticklabels\":true,\"tickfont\":{\"color\":\"rgba(77,77,77,1)\",\"family\":\"\",\"size\":11.68949771689498},\"tickangle\":-0,\"showline\":false,\"linecolor\":null,\"linewidth\":0,\"showgrid\":true,\"gridcolor\":\"rgba(255,255,255,1)\",\"gridwidth\":0.66417600664176002,\"zeroline\":false,\"anchor\":\"y\",\"title\":{\"text\":\"start\",\"font\":{\"color\":\"rgba(0,0,0,1)\",\"family\":\"\",\"size\":14.611872146118724}},\"hoverformat\":\".2f\"},\"yaxis\":{\"domain\":[0,1],\"automargin\":true,\"type\":\"linear\",\"autorange\":false,\"range\":[-0.60499999999999998,12.705],\"tickmode\":\"array\",\"ticktext\":[\"0.0\",\"2.5\",\"5.0\",\"7.5\",\"10.0\",\"12.5\"],\"tickvals\":[0,2.5,5,7.5,10,12.5],\"categoryorder\":\"array\",\"categoryarray\":[\"0.0\",\"2.5\",\"5.0\",\"7.5\",\"10.0\",\"12.5\"],\"nticks\":null,\"ticks\":\"outside\",\"tickcolor\":\"rgba(51,51,51,1)\",\"ticklen\":3.6529680365296811,\"tickwidth\":0.66417600664176002,\"showticklabels\":true,\"tickfont\":{\"color\":\"rgba(77,77,77,1)\",\"family\":\"\",\"size\":11.68949771689498},\"tickangle\":-0,\"showline\":false,\"linecolor\":null,\"linewidth\":0,\"showgrid\":true,\"gridcolor\":\"rgba(255,255,255,1)\",\"gridwidth\":0.66417600664176002,\"zeroline\":false,\"anchor\":\"x\",\"title\":{\"text\":\"rate\",\"font\":{\"color\":\"rgba(0,0,0,1)\",\"family\":\"\",\"size\":14.611872146118724}},\"hoverformat\":\".2f\"},\"shapes\":[{\"type\":\"rect\",\"fillcolor\":null,\"line\":{\"color\":null,\"width\":0,\"linetype\":[]},\"yref\":\"paper\",\"xref\":\"paper\",\"x0\":0,\"x1\":1,\"y0\":0,\"y1\":1}],\"showlegend\":true,\"legend\":{\"bgcolor\":\"rgba(255,255,255,1)\",\"bordercolor\":\"transparent\",\"borderwidth\":1.8897637795275593,\"font\":{\"color\":\"rgba(0,0,0,1)\",\"family\":\"\",\"size\":11.68949771689498},\"title\":{\"text\":\"Member\",\"font\":{\"color\":\"rgba(0,0,0,1)\",\"family\":\"\",\"size\":14.611872146118724}}},\"hovermode\":\"closest\",\"barmode\":\"relative\"},\"config\":{\"doubleClick\":\"reset\",\"modeBarButtonsToAdd\":[\"hoverclosest\",\"hovercompare\"],\"showSendToCloud\":false},\"source\":\"A\",\"attrs\":{\"eb2863e18ce0\":{\"x\":{},\"y\":{},\"colour\":{},\"type\":\"scatter\"},\"eb286ce7f95a\":{\"x\":{},\"y\":{},\"colour\":{}}},\"cur_data\":\"eb2863e18ce0\",\"visdat\":{\"eb2863e18ce0\":[\"function (y) \",\"x\"],\"eb286ce7f95a\":[\"function (y) \",\"x\"]},\"highlight\":{\"on\":\"plotly_click\",\"persistent\":false,\"dynamic\":false,\"selectize\":false,\"opacityDim\":0.20000000000000001,\"selected\":{\"opacity\":1},\"debounce\":0},\"shinyEvents\":[\"plotly_hover\",\"plotly_click\",\"plotly_selected\",\"plotly_relayout\",\"plotly_brushed\",\"plotly_brushing\",\"plotly_clickannotation\",\"plotly_doubleclick\",\"plotly_deselect\",\"plotly_afterplot\",\"plotly_sunburstclick\"],\"base_url\":\"https://plot.ly\"},\"evals\":[],\"jsHooks\":[]}</script>\n```\n:::\n:::\n\n\n\n### Recollections\n\nFor this session we focused more on regex than perhaps we thought we would, with a particular focus on how to produce nicely readable names for different characters. We also focused on producing metrics like appearances per year, given that some of the time periods were full decades, but others were just of a few years within the decade.\n\n## NCAA Men's March Madness\n\nThis session was based around [data from a basketball competition](https://github.com/rfordatascience/tidytuesday/tree/master/data/2024/2024-03-26). It had information both on how well different teams performed against each other, and also how well various members of the public thought they would perform, meaning it can be used to assess how well expectations match with reality. \n\nThis particular session was led by Nic, who supplied the code below. \n\n\n::: {.cell}\n\n```{.r .cell-code}\nif (is.na(utils::packageVersion(\"pacman\"))){\n  install.packages(\"pacman\")\n}\nlibrary(pacman)\np_load(tidytuesdayR)\n \n### Download last tuesday's data\n \ntt_data <- tt_load('2024-03-26')\n```\n\n::: {.cell-output .cell-output-stderr}\n```\n--- Compiling #TidyTuesday Information for 2024-03-26 ----\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\n--- There are 2 files available ---\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\n--- Starting Download ---\n```\n:::\n\n::: {.cell-output .cell-output-stdout}\n```\n\n\tDownloading file 1 of 2: `team-results.csv`\n\tDownloading file 2 of 2: `public-picks.csv`\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\n--- Download complete ---\n```\n:::\n\n```{.r .cell-code}\ntt_data\n```\n\n::: {.cell-output .cell-output-stderr}\n```\nAvailable datasets:\n\tteam-results \n\tpublic-picks \n\t\n```\n:::\n\n```{.r .cell-code}\n### Assign the datasets to our global environment\n \nlist2env(tt_data, globalenv())\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n<environment: R_GlobalEnv>\n```\n:::\n\n```{.r .cell-code}\n# Load packages -----------------------------------------------------------\n \np_load(tidyverse, # The tidyverse\n       cheapr, # Cheap (fast & efficient) functions\n       cppdoubles, # Floating-point comparisons\n       timeplyr, # Date-Time manipulation\n       tidytext, # Text manipulation\n       phsmethods, phsstyles) # PHS functions\n \n \n# Exploratory -------------------------------------------------------------\n \n \noverview(`team-results`)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\nobs: 236 \ncols: 20 \n\n----- Numeric -----\n          col   class n_missing p_complete n_unique   mean   p0   p25   p50\n1      TEAMID numeric         0          1      236 124.33    1 63.75 123.5\n2        PAKE numeric         0          1       75  -0.01 -6.7  -0.8  -0.2\n3    PAKERANK numeric         0          1       75 114.53    1    56   118\n4        PASE numeric         0          1       79      0 -8.5  -0.9 -0.15\n5    PASERANK numeric         0          1       79 114.78    1    59   111\n6       GAMES numeric         0          1       38   8.01    1     2     4\n7           W numeric         0          1       31      4    0     0     1\n8           L numeric         0          1       15      4    1     1     3\n9  WINPERCENT numeric         0          1       55   0.26    0     0  0.25\n10        R64 numeric         0          1       15   4.07    1     1     3\n11        R32 numeric         0          1       15   2.03    0     0     1\n12        S16 numeric         0          1       10   1.02    0     0     0\n13         E8 numeric         0          1        8   0.51    0     0     0\n14         F4 numeric         0          1        6   0.25    0     0     0\n15         F2 numeric         0          1        5   0.13    0     0     0\n16      CHAMP numeric         0          1        4   0.06    0     0     0\n17       TOP2 numeric         0          1       11   0.51    0     0     0\n      p75 p100   iqr    sd\n1  185.25  245 121.5 70.66\n2     0.5   12   1.3  2.21\n3     175  236   119 68.46\n4     0.5 10.6   1.4  2.35\n5     175  236   116 68.58\n6       9   53     7 10.26\n7       4   40     4  7.38\n8       6   15     5  3.31\n9     0.5  0.8   0.5  0.26\n10      6   15     5  3.44\n11      3   15     3  3.01\n12      1    9     1  2.06\n13      0    7     0  1.28\n14      0    5     0  0.78\n15      0    4     0  0.51\n16      0    3     0  0.35\n17      0   12     0  1.56\n\n----- Categorical -----\n           col     class n_missing p_complete n_unique n_levels\n1         TEAM character         0          1      236       NA\n2    F4PERCENT character         0          1      119       NA\n3 CHAMPPERCENT character         0          1       72       NA\n                min    max\n1 Abilene Christian   Yale\n2             0.00% 98.80%\n3             0.00%  9.10%\n```\n:::\n\n```{.r .cell-code}\noverview(`public-picks`)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\nobs: 64 \ncols: 9 \n\n----- Numeric -----\n     col   class n_missing p_complete n_unique    mean   p0     p25    p50\n1   YEAR numeric         0          1        1    2024 2024    2024   2024\n2 TEAMNO numeric         0          1       64 1045.39 1012 1028.75 1045.5\n      p75 p100  iqr    sd\n1    2024 2024    0     0\n2 1062.25 1079 33.5 19.71\n\n----- Categorical -----\n     col     class n_missing p_complete n_unique n_levels   min    max\n1   TEAM character         0          1       64       NA Akron   Yale\n2    R64 character         0          1       64       NA 1.50% 98.41%\n3    R32 character         0          1       62       NA 0.67% 93.59%\n4    S16 character         0          1       60       NA 0.33% 80.22%\n5     E8 character         0          1       54       NA 0.17%  8.37%\n6     F4 character         0          1       42       NA 0.07%  9.99%\n7 FINALS character         0          1       37       NA 0.03%  9.27%\n```\n:::\n\n```{.r .cell-code}\n`public-picks` |>\n  pivot_longer(R64:FINALS) |> \n  group_by(YEAR, TEAMNO) |> \n  mutate(stage = row_number()) %>%\n  mutate(perc = as.numeric(str_remove(value, \"%\")),\n         perc = perc / 100) %>%\n  ggplot(aes(x = stage, y = perc)) + \n  geom_line(aes(group = paste(YEAR, TEAM)))\n```\n\n::: {.cell-output-display}\n![](index_files/figure-html/unnamed-chunk-3-1.png){width=672}\n:::\n\n```{.r .cell-code}\n  # geom_col()\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\ntop_predicted_teams <- `public-picks` |>\n  pivot_longer(R64:FINALS) |> \n  group_by(YEAR, TEAMNO) |> \n  mutate(stage = row_number()) %>%\n  mutate(perc = as.numeric(str_remove(value, \"%\")),\n         perc = perc / 100) %>%\n  filter(stage == 6) %>%\n  arrange(desc(perc)) %>%\n  ungroup() %>%\n  slice(1:5)\n\n`team-results` %>%\n  count(CHAMP)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n# A tibble: 4 × 2\n  CHAMP     n\n  <dbl> <int>\n1     0   227\n2     1     4\n3     2     4\n4     3     1\n```\n:::\n\n```{.r .cell-code}\n`team-results` %>%\n  count(CHAMP)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n# A tibble: 4 × 2\n  CHAMP     n\n  <dbl> <int>\n1     0   227\n2     1     4\n3     2     4\n4     3     1\n```\n:::\n\n```{.r .cell-code}\n`team-results` %>%\n  filter(F2 >= 2)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n# A tibble: 9 × 20\n  TEAMID TEAM    PAKE PAKERANK  PASE PASERANK GAMES     W     L WINPERCENT   R64\n   <dbl> <chr>  <dbl>    <dbl> <dbl>    <dbl> <dbl> <dbl> <dbl>      <dbl> <dbl>\n1     24 Butler   7          4   8.7        4    26    17     9      0.654     9\n2     40 Conne…   8.6        2  10.6        1    29    23     6      0.793     9\n3     50 Duke     2         24   0         78    46    34    12      0.739    14\n4     68 Gonza…   3.1       18   3.8       14    47    32    15      0.681    15\n5     86 Kansas   4.2       13  -1.8      205    53    40    13      0.755    15\n6     90 Kentu…   6.9        6   8.5        5    43    32    11      0.744    12\n7    114 Michi…   7          4   7.6        6    35    24    11      0.686    11\n8    135 North…  12          1   9.8        2    50    39    11      0.78     13\n9    228 Villa…   4.8        9   4         11    40    29    11      0.725    13\n# ℹ 9 more variables: R32 <dbl>, S16 <dbl>, E8 <dbl>, F4 <dbl>, F2 <dbl>,\n#   CHAMP <dbl>, TOP2 <dbl>, F4PERCENT <chr>, CHAMPPERCENT <chr>\n```\n:::\n\n```{.r .cell-code}\ntop_predicted_teams %>%\n  inner_join(`team-results`, by = \"TEAM\")\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n# A tibble: 5 × 26\n   YEAR TEAMNO TEAM         name  value stage   perc TEAMID  PAKE PAKERANK  PASE\n  <dbl>  <dbl> <chr>        <chr> <chr> <int>  <dbl>  <dbl> <dbl>    <dbl> <dbl>\n1  2024   1067 Connecticut  FINA… 34.9…     6 0.349      40   8.6        2  10.6\n2  2024   1038 North Carol… FINA… 12.1…     6 0.121     135  12          1   9.8\n3  2024   1033 Purdue       FINA… 10.2…     6 0.102     167  -4.4      232  -4.4\n4  2024   1056 Houston      FINA… 9.27%     6 0.0927     76   0         76   2.1\n5  2024   1053 Iowa St.     FINA… 4.78%     6 0.0478     83  -2        209  -1.5\n# ℹ 15 more variables: PASERANK <dbl>, GAMES <dbl>, W <dbl>, L <dbl>,\n#   WINPERCENT <dbl>, R64 <dbl>, R32 <dbl>, S16 <dbl>, E8 <dbl>, F4 <dbl>,\n#   F2 <dbl>, CHAMP <dbl>, TOP2 <dbl>, F4PERCENT <chr>, CHAMPPERCENT <chr>\n```\n:::\n:::\n\n\n### Shoutouts \n\nPlease check out Nic's [timeplyr package](https://cran.r-project.org/web/packages/timeplyr/index.html), which is now on CRAN and was masterfully presented at a [previous EdinbR R users' group meeting](http://edinbr.org/edinbr/2024/01/11/January-meeting.html).  ",
    "supporting": [
      "index_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {
      "include-in-header": [
        "<script src=\"../../../site_libs/htmlwidgets-1.6.4/htmlwidgets.js\"></script>\n<script src=\"../../../site_libs/plotly-binding-4.10.4/plotly.js\"></script>\n<script src=\"../../../site_libs/typedarray-0.1/typedarray.min.js\"></script>\n<script src=\"../../../site_libs/jquery-3.5.1/jquery.min.js\"></script>\n<link href=\"../../../site_libs/crosstalk-1.2.1/css/crosstalk.min.css\" rel=\"stylesheet\" />\n<script src=\"../../../site_libs/crosstalk-1.2.1/js/crosstalk.min.js\"></script>\n<link href=\"../../../site_libs/plotly-htmlwidgets-css-2.11.1/plotly-htmlwidgets.css\" rel=\"stylesheet\" />\n<script src=\"../../../site_libs/plotly-main-2.11.1/plotly-latest.min.js\"></script>\n"
      ]
    },
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}