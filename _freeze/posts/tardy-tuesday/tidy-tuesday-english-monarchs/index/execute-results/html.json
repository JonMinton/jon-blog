{
  "hash": "9c6d16405765e844b55cd1ed0ae0f862",
  "result": {
    "markdown": "---\ntitle: \"Tidy Tuesday: English Monarchs\"\ndate: \"2024-08-21\"\ncategories: [tidy tuesday, monarchs, ggplot2, tidyverse, history, regex]\nauthor:\n    - Jon\n    - Kate\n    - Andrew\n    - Brendan\n    - Nic\n    - Kennedy\n    - Miryiam\n    - Gatz\ncode-fold: true\n---\n\n\nThe most recent Tidy Tuesday dataset was about [English kings](https://github.com/rfordatascience/tidytuesday/tree/master/data/2024/2024-08-20) (including female kings - there should be a word for that) and their consorts. \n\nFor a change, Jon led the session. \n\nLoad the data:\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(tidyverse)\n```\n\n::: {.cell-output .cell-output-stderr}\n```\n── Attaching core tidyverse packages ──────────────────────── tidyverse 2.0.0 ──\n✔ dplyr     1.1.4     ✔ readr     2.1.6\n✔ forcats   1.0.1     ✔ stringr   1.6.0\n✔ ggplot2   4.0.0     ✔ tibble    3.3.0\n✔ lubridate 1.9.4     ✔ tidyr     1.3.1\n✔ purrr     1.2.0     \n── Conflicts ────────────────────────────────────────── tidyverse_conflicts() ──\n✖ dplyr::filter() masks stats::filter()\n✖ dplyr::lag()    masks stats::lag()\nℹ Use the conflicted package (<http://conflicted.r-lib.org/>) to force all conflicts to become errors\n```\n:::\n\n```{.r .cell-code}\nenglish_monarchs_marriages_df <- readr::read_csv(\n  'https://raw.githubusercontent.com/rfordatascience/tidytuesday/master/data/2024/2024-08-20/english_monarchs_marriages_df.csv'\n  )\n```\n\n::: {.cell-output .cell-output-stderr}\n```\nRows: 83 Columns: 5\n── Column specification ────────────────────────────────────────────────────────\nDelimiter: \",\"\nchr (5): king_name, king_age, consort_name, consort_age, year_of_marriage\n\nℹ Use `spec()` to retrieve the full column specification for this data.\nℹ Specify the column types or set `show_col_types = FALSE` to quiet this message.\n```\n:::\n:::\n\n\nData tidying - a lot of missing age information for older records, especially for the consorts:\n\n\n::: {.cell}\n\n```{.r .cell-code}\nmar_tidy <-\n  english_monarchs_marriages_df |> \n    mutate(\n      king_age = str_remove_all(king_age, \"\\\\?|\\\\–|\\\\(|\\\\)\") %>% as.numeric(),\n      consort_age = str_remove_all(consort_age, \"\\\\?|\\\\–|\\\\(|\\\\)\") %>% as.numeric(),\n      year_of_marriage= str_remove_all(year_of_marriage, \"\\\\?|\\\\–|\\\\(|\\\\)\") %>% as.numeric()\n    )\n```\n:::\n\n\nFirst plot: age of 'king' against age of consort:\n\n::: {.cell}\n\n```{.r .cell-code}\nmar_tidy |> \n  ggplot(aes(x = king_age, y = consort_age)) +\n  geom_point() +\n  labs(title = \"King Age vs Consort Age\",\n       x = \"King Age\",\n       y = \"Consort Age\",\n       subtitle = \"Most kings were older than their consorts. QE2 Highlighted\"\n  ) +\n  coord_equal(xlim = c(0, 65), ylim = c(0, 65)) +\n  geom_abline(intercept =0, slope = 1, linetype = \"dashed\") +\n  geom_vline(xintercept = 16, linetype = \"dashed\") + \n  geom_point(aes(x = king_age, y = consort_age), shape = 17, size = 3, colour = \"purple\", data = \n               mar_tidy |> filter(king_name == \"Elizabeth II\")\n             )\n```\n\n::: {.cell-output .cell-output-stderr}\n```\nWarning: Removed 25 rows containing missing values or values outside the scale range\n(`geom_point()`).\n```\n:::\n\n::: {.cell-output-display}\n![](index_files/figure-html/unnamed-chunk-3-1.png){width=672}\n:::\n:::\n\n\nWe added a special royal purple triangle for QE2.\n\nWe wanted to know\n\n> Were the 'kings' whose consorts were older than them actually Queens?\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nmar_tidy |> \n  filter(king_age < consort_age) |> \n  select(king_name, consort_name, king_age, consort_age, year_of_marriage) |> \n  distinct() |> \n  arrange(king_age, consort_age)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n# A tibble: 8 × 5\n  king_name    consort_name                king_age consort_age year_of_marriage\n  <chr>        <chr>                          <dbl>       <dbl>            <dbl>\n1 Richard II   Anne of Bohemia                   15          16             1382\n2 Mary II      William III                       15          27             1677\n3 Henry VIII   Catherine of Aragon               18          24             1509\n4 Anne         George of Denmark                 18          30             1683\n5 Henry II     Eleanor of Aquitaine              19          30             1152\n6 Elizabeth II Philip of Greece and Denma…       21          26             1947\n7 Edward IV    Elizabeth Woodville               22          27             1464\n8 George IV    Maria Anne Fitzherbert            23          29             1785\n```\n:::\n:::\n\n\nFemale 'kings' are over-represented but not the majority\n\nNow difference between king and consort age by year of marriage \n\n\n::: {.cell}\n\n```{.r .cell-code}\nmar_tidy |> \n  mutate(age_diff = king_age - consort_age) |>\n  ggplot(aes(x = year_of_marriage, y = age_diff)) +\n  geom_point() +\n  labs(title = \"Difference between King and Consort Age by Year of Marriage\",\n       x = \"Year of Marriage\",\n       y = \"Difference between King and Consort Age\"\n  ) +\n  geom_hline(yintercept = 0, linetype = \"dashed\") +\n  geom_smooth()\n```\n\n::: {.cell-output .cell-output-stderr}\n```\n`geom_smooth()` using method = 'loess' and formula = 'y ~ x'\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\nWarning: Removed 25 rows containing non-finite outside the scale range\n(`stat_smooth()`).\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\nWarning: Removed 25 rows containing missing values or values outside the scale range\n(`geom_point()`).\n```\n:::\n\n::: {.cell-output-display}\n![](index_files/figure-html/unnamed-chunk-5-1.png){width=672}\n:::\n:::\n\n\nThe age gap between kings and consorts appears to have been falling from around 1500. \n(Note: neither of King Charles' consorts are in the dataset as he was not a king at the time of either marriage)\n\nWas there any obvious tendency for English Kings to have multiple wives, and - like Leo DeCaprio - keep partnering with young women as they age? \n\n\n::: {.cell}\n\n```{.r .cell-code}\nmar_tidy |> \n  group_by(king_name) |> \n  mutate(king_count = n()) |> \n  filter(king_count > 1) |> \n  filter(year_of_marriage > 1000) \n```\n\n::: {.cell-output .cell-output-stdout}\n```\n# A tibble: 25 × 6\n# Groups:   king_name [11]\n   king_name       king_age consort_name consort_age year_of_marriage king_count\n   <chr>              <dbl> <chr>              <dbl>            <dbl>      <int>\n 1 Æthelred the U…       34 Emma of Nor…          17             1002          2\n 2 Cnut                  18 Aelfgifu of…          NA             1013          2\n 3 Cnut                  22 Emma of Nor…          NA             1017          2\n 4 Harold Godwins…       24 Edith Swann…          19             1044          2\n 5 Harold Godwins…       42 Ealdgyth              NA             1064          2\n 6 Henry I               32 Matilda of …          20             1100          2\n 7 Henry I               53 Adeliza of …          18             1121          2\n 8 John                  23 Isabel of G…          16             1189          2\n 9 John                  34 Isabella of…          12             1200          2\n10 Edward I              15 Eleanor of …          13             1254          2\n# ℹ 15 more rows\n```\n:::\n:::\n\n\nFor many marriages the ages of the consorts weren't known (the records are from hundreds of years ago, so maybe that's to be expected). \n\n\n::: {.cell}\n\n```{.r .cell-code}\nmar_tidy |> \n  group_by(king_name) |> \n  mutate(king_count = n()) |> \n  filter(king_count > 1) |> \n  filter(!is.na(consort_age)) |>\n  ggplot(aes(x = king_age, y = consort_age)) +\n  geom_line() +\n  geom_point() +\n  coord_equal() + \n  coord_equal(xlim = c(0, 65), ylim = c(0, 65)) +\n  geom_abline(intercept =0, slope = 1, linetype = \"dashed\") +\n  facet_wrap(~king_name) + \n  labs(\n    x = \"Age of king\",\n    y = \"Age of consort\",\n    title = \"Ages of kings and consorts for multiple-marrying kings\"\n  )\n```\n\n::: {.cell-output .cell-output-stderr}\n```\nCoordinate system already present.\nℹ Adding new coordinate system, which will replace the existing one.\n`geom_line()`: Each group consists of only one observation.\nℹ Do you need to adjust the group aesthetic?\n`geom_line()`: Each group consists of only one observation.\nℹ Do you need to adjust the group aesthetic?\n`geom_line()`: Each group consists of only one observation.\nℹ Do you need to adjust the group aesthetic?\n```\n:::\n\n::: {.cell-output-display}\n![](index_files/figure-html/unnamed-chunk-7-1.png){width=672}\n:::\n:::\n\n\nHenry VIII is clearly an outlier in terms of the number of marriages he had. But there's no clear tendency for English kings to marry with Hollywood tendencies. \n\nEven where some kings have been married multiple times, the age of the consorts might only have been recorded one or zero times. \n\nFor many of the older records honourifics (and in some cases dishonourifics) were applied to the name. These were identified by the king name having the word 'the' in them:\n\n\n::: {.cell}\n\n```{.r .cell-code}\nmar_tidy |>\n  filter(str_detect(king_name, \" the \")) |> \n  pull(king_name) |>\n  unique()\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] \"Alfred the Great\"     \"Edward the Elder\"     \"Edgar the Peaceful\"  \n[4] \"Edward the Martyr\"    \"Æthelred the Unready\" \"Edward the Confessor\"\n[7] \"Henry the Young King\"\n```\n:::\n:::\n\n\nBetter to be 'unready' or a 'martyr'? (probably best to be unready to be a martyr!)\n",
    "supporting": [
      "index_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}